<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PaTí - De todo</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/exceljs@4.4.0/dist/exceljs.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/file-saver@2.0.5/dist/FileSaver.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/pocketbase@0.21.1/dist/pocketbase.umd.js"></script>
	<script src="js/app.js"></script>
	<style>
        :root {
            --gold-light: #F5F0E6;
            --gold: #D4AF37;
            --gold-dark: #B8860B;
            --gold-darker: #8B6510;
            --brown: #8B4513;
            --brown-dark: #654321;
            --white: #FFFFFF;
            --black: #000000;
            --gray-light: #F8F9FA;
            --gray: #6C757D;
            --gray-dark: #343A40;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--gold-light);
            color: var(--brown-dark);
        }
        .navbar {
            background: linear-gradient(90deg, var(--gold-darker) 0%, var(--brown-dark) 100%);
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        .navbar-brand {
            font-weight: 800;
            font-size: 1.8rem;
            color: var(--gold) !important;
            text-shadow: 1px 1px 2px var(--brown-dark);
        }
        .navbar-nav .nav-link {
            color: var(--gold-light) !important;
            font-weight: 500;
            transition: all 0.3s;
        }
        .navbar-nav .nav-link:hover {
            color: var(--gold) !important;
        }
        .btn-primary {
            background-color: var(--gold);
            border-color: var(--gold);
            color: var(--brown-dark);
            font-weight: 600;
        }
        .btn-primary:hover {
            background-color: var(--gold-dark);
            border-color: var(--gold-dark);
            color: var(--brown-dark);
        }
        .btn-outline-light {
            color: var(--gold-light);
            border-color: var(--gold-light);
        }
        .btn-outline-light:hover {
            background-color: var(--gold);
            border-color: var(--gold);
            color: var(--brown-dark);
        }
        .hero-section {
            background: linear-gradient(rgba(0, 0, 0, 0.6), rgba(0, 0, 0, 0.6)), url('https://images.unsplash.com/photo-1607082348824-0a96f2a4b9da?ixlib=rb-4.0.3&auto=format&fit=crop&w=1920&q=80') no-repeat center center;
            background-size: cover;
            color: var(--gold-light);
            padding: 5rem 0;
            text-align: center;
            margin-bottom: 2rem;
        }
        .hero-content {
            max-width: 800px;
            margin: 0 auto;
            padding: 2rem;
            background-color: rgba(139, 101, 16, 0.8);
            border-radius: 10px;
        }
        .product-card {
            transition: transform 0.3s, box-shadow 0.3s;
            height: 100%;
            background-color: var(--white);
            border: 1px solid var(--gold);
            border-radius: 8px;
            overflow: hidden;
        }
        .product-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }
        .product-image {
            height: 200px;
            object-fit: contain;
            padding: 10px;
            background-color: var(--gold-light);
        }
        .cart-icon {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
            background: var(--gold);
            color: var(--brown-dark);
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
            font-weight: bold;
        }
        .cart-badge {
            position: absolute;
            top: 0;
            right: 0;
            background: var(--brown);
            color: var(--gold-light);
            border-radius: 50%;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
        }
        .about-section {
            background-color: var(--white);
            padding: 3rem 0;
            border-top: 3px solid var(--gold);
            border-bottom: 3px solid var(--gold);
        }
        .delivery-info {
            background-color: var(--gold-light);
            padding: 1.5rem;
            border-radius: 8px;
            border-left: 4px solid var(--gold);
            margin: 2rem 0;
        }
        .delivery-price {
            font-weight: bold;
            color: var(--brown);
        }
        .admin-container {
            display: flex;
            min-height: 100vh;
        }
        .admin-sidebar {
            width: 250px;
            background: linear-gradient(180deg, var(--brown-dark) 0%, var(--gold-darker) 100%);
            color: var(--gold-light);
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.1);
            overflow-y: auto;
        }
        .admin-sidebar-header {
            padding: 20px;
            text-align: center;
            border-bottom: 1px solid var(--gold);
        }
        .admin-menu {
            padding: 20px 0;
        }
        .admin-menu-item {
            padding: 12px 20px;
            display: flex;
            align-items: center;
            cursor: pointer;
            transition: all 0.3s;
            color: var(--gold-light);
        }
        .admin-menu-item:hover {
            background-color: rgba(212, 175, 55, 0.2);
        }
        .admin-menu-item.active {
            background-color: rgba(212, 175, 55, 0.3);
            border-left: 4px solid var(--gold);
        }
        .admin-menu-item i {
            margin-right: 10px;
            font-size: 18px;
        }
        .admin-content {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            background-color: var(--gold-light);
        }
        .admin-topbar {
            background-color: var(--white);
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
            margin-bottom: 20px;
            border-radius: 8px;
            border-bottom: 3px solid var(--gold);
        }
        .logout-btn {
            background-color: var(--brown);
            color: var(--gold-light);
            padding: 8px 15px;
            border-radius: 4px;
            border: none;
            cursor: pointer;
            font-weight: 500;
        }
        .logout-btn:hover {
            background-color: var(--brown-dark);
        }
        .stats-card {
            text-align: center;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            color: var(--white);
            background: linear-gradient(90deg, var(--gold-darker) 0%, var(--brown-dark) 100%);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        .category-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            z-index: 1;
            background-color: var(--brown);
            color: var(--gold-light);
        }
        .modal-content {
            border: 2px solid var(--gold);
            border-radius: 10px;
        }
        .modal-header {
            background-color: var(--gold);
            color: var(--brown-dark);
            border-bottom: 2px solid var(--gold-dark);
        }
        .form-control:focus {
            border-color: var(--gold);
            box-shadow: 0 0 0 0.25rem rgba(212, 175, 55, 0.25);
        }
        .about-content {
            max-width: 800px;
            margin: 0 auto;
            padding: 2rem;
            background-color: var(--white);
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        .amazed-person {
            display: flex;
            align-items: center;
            background-color: var(--gold-light);
            padding: 1.5rem;
            border-radius: 10px;
            margin: 2rem 0;
            border-left: 4px solid var(--gold);
        }
        .amazed-person img {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            object-fit: cover;
            margin-right: 1.5rem;
            border: 3px solid var(--gold);
        }
        .table-responsive {
            border-radius: 8px;
            overflow: hidden;
        }
        .table th {
            background-color: var(--gold);
            color: var(--brown-dark);
        }
        .action-buttons {
            display: flex;
            gap: 5px;
        }
        .btn-sm {
            padding: 0.25rem 0.5rem;
            font-size: 0.875rem;
        }
        .product-summary {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        .summary-card {
            flex: 1;
            min-width: 200px;
            background: linear-gradient(90deg, var(--gold-darker) 0%, var(--brown-dark) 100%);
            color: white;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }
        .summary-value {
            font-size: 24px;
            font-weight: bold;
        }
        .summary-label {
            font-size: 14px;
        }
        .import-section {
            background-color: var(--white);
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            border-left: 4px solid var(--gold);
        }
        .admin-tab-content {
            display: none;
        }
        #adminDashboardTab {
            display: block;
        }
        .quantity-control {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-top: 10px;
        }
        .quantity-control button {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: var(--gold);
            color: var(--brown-dark);
            border: none;
            font-weight: bold;
        }
        .quantity-control input {
            width: 50px;
            text-align: center;
            border: 1px solid var(--gold);
            margin: 0 10px;
            border-radius: 4px;
        }
        .price-tier {
            font-size: 0.9rem;
            color: var(--gray);
            margin-top: 5px;
        }
        .price-tier span {
            font-weight: bold;
            color: var(--brown-dark);
        }
        .store-card {
            background-color: var(--white);
            border: 1px solid var(--gold);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            transition: transform 0.3s;
        }
        .store-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        .store-status {
            display: inline-block;
            padding: 3px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: bold;
        }
        .status-active {
            background-color: rgba(40, 167, 69, 0.2);
            color: #28a745;
        }
        .status-inactive {
            background-color: rgba(220, 53, 69, 0.2);
            color: #dc3545;
        }
        .login-role-btn {
            margin: 10px;
            padding: 15px 30px;
            font-size: 1.1rem;
            border-radius: 8px;
            background-color: var(--gold);
            color: var(--brown-dark);
            border: none;
            font-weight: 600;
            transition: all 0.3s;
        }
        .login-role-btn:hover {
            background-color: var(--gold-dark);
            color: var(--brown-dark);
            transform: translateY(-3px);
        }
        @media (max-width: 768px) {
            .product-card {
                margin-bottom: 20px;
            }
            .hero-section h1 {
                font-size: 2rem;
            }
            .admin-container {
                flex-direction: column;
            }
            .admin-sidebar {
                width: 100%;
            }
            .amazed-person {
                flex-direction: column;
                text-align: center;
            }
            .amazed-person img {
                margin-right: 0;
                margin-bottom: 1rem;
            }
            .action-buttons {
                flex-direction: column;
            }
            .product-summary {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark sticky-top">
        <div class="container">
            <a class="navbar-brand" href="#" onclick="showSection('home')">PaTí</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item"><a class="nav-link" href="#" onclick="showSection('home')">Inicio</a></li>
                    <li class="nav-item"><a class="nav-link" href="#" onclick="showSection('products')">Productos</a></li>
                    <li class="nav-item"><a class="nav-link" href="#" onclick="showSection('about')">Nosotros</a></li>
                    <li class="nav-item"><a class="nav-link" href="#" onclick="showSection('contact')">Contactos</a></li>
                    <li class="nav-item"><a class="nav-link" href="#" onclick="showStoreSelection()">Tiendas</a></li>
                    <!-- ✅ CORRECCIÓN: Botón "Administrador" ahora llama a showAdminLogin() -->
                    <button class="btn btn-outline-light" onclick="showAdminLogin()">
						<i class="fas fa-cog"></i> Administrador
					</button>
                </ul>
                <div class="d-none" id="authButtons">
                    <button class="btn btn-outline-light me-2" onclick="showLoginForm()">
                        <i class="fas fa-sign-in-alt"></i> Iniciar Sesión
                    </button>
                </div>
                <div class="d-none" id="logoutButton">
                    <button class="btn btn-outline-light" onclick="logout()">
                        <i class="fas fa-sign-out-alt"></i> Cerrar Sesión
                    </button>
                </div>
            </div>
        </div>
    </nav>
    <!-- Main Content Sections -->
    <div id="mainContent">
        <!-- Home Section -->
        <section id="homeSection">
            <div class="hero-section">
                <div class="hero-content">
                    <h1 class="display-4 fw-bold">Bienvenido a PaTí</h1>
                    <p class="lead">"De todo" para todos los gustos y necesidades</p>
                    <button class="btn btn-primary btn-lg me-3" onclick="showStoreSelection()">Entra a tu tienda ahora</button>
                    <button class="btn btn-outline-light btn-lg" onclick="checkCreateStorePermission()">Monta tu tienda hoy </button>
                </div>
            </div>
            <div class="container mb-5">
                <div class="amazed-person">
                    <img src="https://cdn.b12.io/client_media/QxJcSkIK/ecb4925e-72e0-11f0-8eab-0242ac110002-jpeg-hero_image.jpeg" alt="Cliente asombrado">
                    <div>
                        <h3>¡Estoy asombrado!</h3>
                        <p>Nunca imaginé encontrar tantos productos de calidad en un solo lugar. PaTí tiene todo lo que necesito y a precios increíbles. ¡La entrega a domicilio es un servicio excelente!</p>
                        <button class="btn btn-primary mt-2" onclick="showStoreSelection()">Quiero comprar ahora</button>
                    </div>
                </div>
                <h2 class="text-center mb-4">Tiendas Destacadas</h2>
                <div class="row" id="featuredStores">
                    <!-- Featured stores will be loaded here -->
                </div>
            </div>
        </section>
        <!-- Products Section -->
        <section id="productsSection" class="container mb-5" style="display: none;">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h2>Nuestros Productos</h2>
            </div>
            <div class="row mb-4">
				<!-- Filtro por tienda (solo visible en la plataforma principal, no en tienda específica) -->
				<div class="col-md-3" id="storeFilterContainer" style="display: none;">
					<select class="form-select" id="storeFilter" onchange="filterProductsAdvanced()">
						<option value="">Todas las tiendas</option>
					</select>
				</div>
				<div class="col-md-3">
					<input type="text" class="form-control" id="searchProduct" placeholder="Buscar productos..." onkeyup="filterProductsAdvanced()">
				</div>
				<div class="col-md-3">
					<select class="form-select" id="categoryFilter" onchange="filterProductsAdvanced()">
						<option value="">Todas las categorías</option>
						<option value="C001">Electrónica</option>
						<option value="C002">Hogar</option>
						<option value="C003">Útiles y Herramientas</option>
						<option value="C004">Ropas</option>
						<option value="C005">Calzados</option>
						<option value="C006">Deportiva</option>
					</select>
				</div>
				<div class="col-md-3">
					<div class="input-group">
						<input type="number" class="form-control" id="priceMin" placeholder="$ Mín" onchange="filterProductsAdvanced()">
						<span class="input-group-text">-</span>
						<input type="number" class="form-control" id="priceMax" placeholder="$ Máx" onchange="filterProductsAdvanced()">
					</div>
				</div>
			</div>
            <div class="row" id="productsList">
            <!-- Products will be loaded here -->
            </div>
        </section>
        <!-- About Section -->
        <section id="aboutSection" class="container mb-5" style="display: none;">
            <div class="about-content">
                <h2 class="text-center mb-4">Acerca de PaTí</h2>
                <p>PaTí es tu plataforma de tiendas en línea donde encontrarás "de todo" para satisfacer todas tus necesidades. Nuestra misión es ofrecerte productos de calidad a precios accesibles con un servicio de entrega a domicilio rápido y confiable.</p>
                <div class="delivery-info">
                    <h4><i class="fas fa-truck"></i> Servicio de Entrega</h4>
                    <p>Ofrecemos entrega a domicilio en toda la ciudad. El costo de envío es de <span class="delivery-price">$2.50</span> para pedidos menores a $50. Para pedidos superiores a $50, el envío es <strong>GRATIS</strong>.</p>
                    <p>Nuestro horario de entregas es de lunes a sábado de 9:00 am a 8:00 pm.</p>
                </div>
                <h4 class="mt-4">Nuestra Historia</h4>
                <p>PaTí nació en 2020 con la visión de crear una plataforma de tiendas en línea que ofreciera una amplia variedad de productos para toda la familia. Desde nuestros humildes comienzos, hemos crecido gracias a la confianza de nuestros clientes y ahora contamos con cientos de productos en nuestro catálogo.</p>
                <h4 class="mt-4">¿Por qué elegirnos?</h4>
                <ul>
                    <li>Amplia variedad de productos de calidad</li>
                    <li>Precios competitivos</li>
                    <li>Entrega rápida y confiable</li>
                    <li>Atención al cliente excepcional</li>
                    <li>Programa de afiliados con atractivas comisiones</li>
                </ul>
            </div>
        </section>
        <!-- Contact Section -->
        <section id="contactSection" class="container mb-5" style="display: none;">
            <div class="about-content">
                <h2 class="text-center mb-4">Contáctanos</h2>
                <div class="row">
                    <div class="col-md-6">
                        <h4>Información de Contacto</h4>
                        <p><i class="fas fa-map-marker-alt"></i> Av. Principal #123, Ciudad</p>
                        <p><i class="fas fa-phone"></i> (123) 456-7890</p>
                        <p><i class="fas fa-envelope"></i> info@pati.com</p>
                        <p><i class="fas fa-clock"></i> Lunes a Sábado: 9:00 am - 8:00 pm</p>
                    </div>
                    <div class="col-md-6">
                        <h4>Envíanos un Mensaje</h4>
                        <form id="contactForm">
                            <div class="mb-3">
                                <input type="text" class="form-control" placeholder="Nombre" required>
                            </div>
                            <div class="mb-3">
                                <input type="email" class="form-control" placeholder="Correo electrónico" required>
                            </div>
                            <div class="mb-3">
                                <textarea class="form-control" rows="4" placeholder="Mensaje" required></textarea>
                            </div>
                            <button type="submit" class="btn btn-primary">Enviar Mensaje</button>
                        </form>
                    </div>
                </div>
            </div>
        </section>
        <!-- Store Selection Section -->
        <section id="storeSelectionSection" class="container mb-5" style="display: none;">
            <div class="about-content">
                <h2 class="text-center mb-4">Selecciona una Tienda</h2>
                <div class="row mb-4">
                    <div class="col-md-6">
                        <input type="text" class="form-control" id="searchStore" placeholder="Buscar tiendas..." onkeyup="filterStores()">
                    </div>
                    <div class="col-md-6">
                        <select class="form-select" id="categoryStoreFilter" onchange="filterStores()">
                            <option value="">Todas las categorías</option>
                            <option value="C001">Electrónica</option>
                            <option value="C002">Hogar</option>
                            <option value="C003">Útiles y Herramientas</option>
                            <option value="C004">Ropas</option>
                            <option value="C005">Calzados</option>
                            <option value="C006">Deportiva</option>
                        </select>
                    </div>
                </div>
                <div class="row" id="storesList">
                    <!-- Stores will be loaded here -->
                </div>
            </div>
        </section>
        <!-- Create Store Section -->
        <section id="createStoreSection" class="container mb-5" style="display: none;">
            <div class="about-content">
                <h2 class="text-center mb-4">Crea tu Tienda</h2>
                <form id="createStoreForm">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="storeName" class="form-label">Nombre de la Tienda</label>
                                <input type="text" class="form-control" id="storeName" required>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="storeCategory" class="form-label">Categoría Principal</label>
                                <select class="form-select" id="storeCategory" required>
                                    <option value="">Seleccionar categoría</option>
                                    <option value="C001">Electrónica</option>
                                    <option value="C002">Hogar</option>
                                    <option value="C003">Útiles y Herramientas</option>
                                    <option value="C004">Ropas</option>
                                    <option value="C005">Calzados</option>
                                    <option value="C006">Deportiva</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="adminName" class="form-label">Nombre del Administrador</label>
                                <input type="text" class="form-control" id="adminName" required>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="adminEmail" class="form-label">Correo del Administrador</label>
                                <input type="email" class="form-control" id="adminEmail" required>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="adminPassword" class="form-label">Contraseña</label>
                                <input type="password" class="form-control" id="adminPassword" required>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="adminPhone" class="form-label">Teléfono</label>
                                <input type="tel" class="form-control" id="adminPhone" required>
                            </div>
                        </div>
                    </div>
                    <div class="mb-3">
                        <label for="storeDescription" class="form-label">Descripción de la Tienda</label>
                        <textarea class="form-control" id="storeDescription" rows="3" required></textarea>
                    </div>
                    <div class="mb-3">
                        <label for="storeImage" class="form-label">URL de Imagen Representativa</label>
                        <input type="url" class="form-control" id="storeImage">
                    </div>
                    <div class="mb-3">
                        <label for="storeLogo" class="form-label">URL del Logo de la Tienda (opcional)</label>
                        <input type="url" class="form-control" id="storeLogo">
                    </div>
                    <button type="submit" class="btn btn-primary w-100">Crear Tienda</button>
                </form>
            </div>
        </section>
        <!-- Store Login Section -->
        <section id="storeLoginSection" class="container mb-5" style="display: none;">
            <div class="about-content">
                <h2 class="text-center mb-4">Iniciar Sesión en <span id="storeLoginName"></span></h2>
                <div class="row justify-content-center">
                    <div class="col-md-8">
                        <div class="text-center mb-4">
                            <p>Selecciona tu tipo de cuenta para iniciar sesión</p>
                        </div>
                        <div class="d-flex flex-column align-items-center">
							<button class="login-role-btn" onclick="showLoginForm('customer')">
								<i class="fas fa-user me-2"></i> Cliente
							</button>
							<button class="login-role-btn" onclick="showLoginForm('affiliate')">
								<i class="fas fa-handshake me-2"></i> Afiliado
							</button>
							<button class="login-role-btn" onclick="showLoginForm('dependiente')">
								<i class="fas fa-user-tie me-2"></i> Dependiente
							</button>
							<button class="login-role-btn" onclick="showLoginForm('admin')">
								<i class="fas fa-cog me-2"></i> Administrador
							</button>
						</div>
                    </div>
                </div>
            </div>
        </section>
    </div>
    <!-- Login Modal -->
    <div class="modal fade" id="loginModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Iniciar Sesión</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="loginForm">
                        <input type="hidden" id="loginRole" value="customer">
                        <input type="hidden" id="loginStoreId" value="">
                        <div class="mb-3">
                            <label for="loginEmail" class="form-label">Correo electrónico</label>
                            <input type="email" class="form-control" id="loginEmail" required>
                        </div>
                        <div class="mb-3">
                            <label for="loginPassword" class="form-label">Contraseña</label>
                            <input type="password" class="form-control" id="loginPassword" required>
                        </div>
                        <div class="mb-3 form-check">
                            <input type="checkbox" class="form-check-input" id="rememberMe">
                            <label class="form-check-label" for="rememberMe">Recordarme</label>
                        </div>
                        <button type="submit" class="btn btn-primary w-100">Iniciar Sesión</button>
                    </form>
                    <div class="text-center mt-3">
                        <a href="#" onclick="showRegisterForm()">¿No tienes cuenta? Regístrate</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Admin Login Modal - CORREGIDO -->
	<!-- Admin Login Modal - VERSIÓN SIMPLIFICADA -->
	<div class="modal fade" id="adminLoginModal" tabindex="-1" data-bs-backdrop="static">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title">Acceso Propietario</h5>
					<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
				</div>
				<div class="modal-body">
					<div class="mb-3">
						<label for="adminUsername" class="form-label">Usuario</label>
						<input type="text" class="form-control" id="adminUsername" value="propietario" required>
					</div>
					<div class="mb-3">
						<label for="adminPassword" class="form-label">Contraseña</label>
						<input type="password" class="form-control" id="adminPassword" value="propietario123" required>
					</div>
					<div class="d-grid gap-2">
						<button type="button" class="btn btn-primary" onclick="loginAsOwnerAndClose()">
							Ingresar como Propietario
						</button>
						<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
							Cancelar
						</button>
					</div>
				</div>
			</div>
		</div>
	</div>

	<script>
	// FUNCIÓN NUEVA - SOLO PARA ESTE MODAL
	function loginAsOwnerAndClose() {
		const username = document.getElementById('adminUsername').value.trim();
		const password = document.getElementById('adminPassword').value.trim();
		
		if (!username || !password) {
			alert('Por favor, ingresa usuario y contraseña');
			return;
		}
		
		const email = username === 'propietario' ? 'propietario@pati.com' : username;
		
		// 1. CERRAR MODAL PRIMERO (esto SÍ funciona)
		const modalElement = document.getElementById('adminLoginModal');
		const modalInstance = bootstrap.Modal.getInstance(modalElement);
		
		if (modalInstance) {
			modalInstance.hide();
		} else {
			// Fallback directo
			modalElement.style.display = 'none';
			document.body.classList.remove('modal-open');
			const backdrop = document.querySelector('.modal-backdrop');
			if (backdrop) backdrop.remove();
		}
		
		// 2. LUEGO HACER LOGIN
		setTimeout(() => {
			userLogin(email, password, 'propietario', null)
				.catch(error => {
					console.error('Login error:', error);
					// Si falla, mostrar modal de nuevo
					const newModal = new bootstrap.Modal(document.getElementById('adminLoginModal'));
					newModal.show();
				});
		}, 100);
	}
	</script>
    <!-- Register Modal -->
    <div class="modal fade" id="registerModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Crear Cuenta</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="registerForm">
                        <input type="hidden" id="registerRole" value="customer">
                        <input type="hidden" id="registerStoreId" value="">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="registerName" class="form-label">Nombre Completo</label>
                                    <input type="text" class="form-control" id="registerName" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="registerEmail" class="form-label">Correo electrónico</label>
                                    <input type="email" class="form-control" id="registerEmail" required>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="registerPassword" class="form-label">Contraseña</label>
                                    <input type="password" class="form-control" id="registerPassword" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="registerConfirmPassword" class="form-label">Confirmar Contraseña</label>
                                    <input type="password" class="form-control" id="registerConfirmPassword" required>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="registerPhone" class="form-label">Teléfono</label>
                                    <input type="tel" class="form-control" id="registerPhone" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="registerAddress" class="form-label">Dirección</label>
                                    <input type="text" class="form-control" id="registerAddress" required>
                                </div>
                            </div>
                        </div>
                        <!-- Affiliate specific fields -->
                        <div id="affiliateFields" style="display: none;">
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label for="affiliateCardUSD" class="form-label">Tarjeta USD</label>
                                        <input type="text" class="form-control" id="affiliateCardUSD" placeholder="Número de tarjeta">
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label for="affiliateCardCUP" class="form-label">Tarjeta CUP</label>
                                        <input type="text" class="form-control" id="affiliateCardCUP" placeholder="Número de tarjeta">
                                    </div>
                                </div>
                            </div>
                        </div>
                        <button type="submit" class="btn btn-primary w-100">Crear Cuenta</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
    <!-- Admin Panel -->
	<div id="adminPanel" class="d-none">
		<div class="admin-container">
			<div class="admin-sidebar">
				<div class="admin-sidebar-header">
					<h3 id="adminPanelTitle">Panel de Administración</h3>
				</div>
				<div class="admin-menu" id="adminMenu">
					<!-- El menú se generará dinámicamente por JavaScript -->
				</div>
			</div>
			<div class="admin-content">
				<div class="admin-topbar">
					<h4 id="adminPanelHeader">Panel de Administración - PaTí</h4>
					<div>
						<button id="viewSiteButton" class="btn btn-outline-primary me-2" onclick="viewSite()" style="display: none;">
							<i class="fas fa-globe"></i> Ver Sitio Web
						</button>
						<button class="logout-btn" onclick="logout()">
							<i class="fas fa-sign-out-alt"></i> Cerrar Sesión
						</button>
					</div>
				</div>
				<!-- Contenido de las pestañas -->
				<div id="adminDashboardTab" class="admin-tab-content">
					<h5 class="mb-4">Resumen del Sistema</h5>
					<div class="product-summary">
						<div class="summary-card">
							<div class="summary-value">12</div>
							<div class="summary-label">Tiendas</div>
						</div>
						<div class="summary-card">
							<div class="summary-value">153</div>
							<div class="summary-label">Productos</div>
						</div>
						<div class="summary-card">
							<div class="summary-value">24</div>
							<div class="summary-label">Pedidos Hoy</div>
						</div>
						<div class="summary-card">
							<div class="summary-value">$1,245.80</div>
							<div class="summary-label">Ventas Hoy</div>
						</div>
					</div>
					<div class="row">
						<div class="col-md-8">
							<div class="card mb-4">
								<div class="card-header bg-primary text-white">
									<i class="fas fa-chart-line"></i> Ventas de los últimos 7 días
								</div>
								<div class="card-body">
									<canvas id="salesChart" height="250"></canvas>
								</div>
							</div>
						</div>
						<div class="col-md-4">
							<div class="card mb-4">
								<div class="card-header bg-success text-white">
									<i class="fas fa-chart-pie"></i> Categorías más vendidas
								</div>
								<div class="card-body">
									<canvas id="categoriesChart" height="250"></canvas>
								</div>
							</div>
						</div>
					</div>
					<div class="card">
						<div class="card-header bg-info text-white">
							<i class="fas fa-exclamation-circle"></i> Alertas y Notificaciones
						</div>
						<div class="card-body">
							<div class="alert alert-warning">
								<i class="fas fa-exclamation-triangle"></i> 5 productos con stock bajo
							</div>
							<div class="alert alert-info">
								<i class="fas fa-info-circle"></i> 3 pedidos pendientes de envío
							</div>
							<div class="alert alert-success">
								<i class="fas fa-check-circle"></i> Sistema funcionando correctamente
							</div>
						</div>
					</div>
				</div>
				<!-- Stores Tab -->
				<div id="adminStoresTab" class="admin-tab-content">
					<div class="d-flex justify-content-between align-items-center mb-4">
						<h5>Gestión de Tiendas</h5>
						<button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addStoreModal">
							<i class="fas fa-plus"></i> Agregar Tienda
						</button>
					</div>
					<div class="table-responsive">
						<table class="table table-striped table-hover">
							<thead>
								<tr>
									<th>ID</th>
									<th>Nombre</th>
									<th>Categoría</th>
									<th>Administrador</th>
									<th>Estado</th>
									<th>Acciones</th>
								</tr>
							</thead>
							<tbody id="adminStoresTable">
								<!-- Stores will be loaded here -->
							</tbody>
						</table>
					</div>
				</div>
				<!-- Products Tab -->
				<div id="adminProductsTab" class="admin-tab-content">
					<div class="d-flex justify-content-between align-items-center mb-4">
						<h5>Gestión de Productos</h5>
						<button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addProductModal">
							<i class="fas fa-plus"></i> Agregar Producto
						</button>
					</div>
					<div class="table-responsive">
						<table class="table table-striped table-hover">
							<thead>
								<tr>
									<th>ID</th>
									<th>Nombre</th>
									<th>Tienda</th>
									<th>Categoría</th>
									<th>Precios</th>
									<th>Stock</th>
									<th>Acciones</th>
								</tr>
							</thead>
							<tbody id="adminProductsTable">
								<!-- Products will be loaded here -->
							</tbody>
						</table>
					</div>
				</div>
				<!-- Categories Tab -->
				<div id="adminCategoriesTab" class="admin-tab-content">
					<div class="d-flex justify-content-between align-items-center mb-4">
						<h5>Gestión de Categorías</h5>
						<button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addCategoryModal">
							<i class="fas fa-plus"></i> Agregar Categoría
						</button>
					</div>
					<div class="table-responsive">
						<table class="table table-striped table-hover">
							<thead>
								<tr>
									<th>ID</th>
									<th>Nombre</th>
									<th>Descripción</th>
									<th>Productos</th>
									<th>Acciones</th>
								</tr>
							</thead>
							<tbody id="adminCategoriesTable">
								<!-- Categories will be loaded here -->
							</tbody>
						</table>
					</div>
				</div>
				<!-- Customers Tab -->
				<div id="adminCustomersTab" class="admin-tab-content">
					<h5 class="mb-4">Gestión de Clientes</h5>
					<div class="table-responsive">
						<table class="table table-striped table-hover">
							<thead>
								<tr>
									<th>ID</th>
									<th>Nombre</th>
									<th>Email</th>
									<th>Tienda</th>
									<th>Pedidos</th>
									<th>Acciones</th>
								</tr>
							</thead>
							<tbody id="adminCustomersTable">
								<!-- Customers will be loaded here -->
							</tbody>
						</table>
					</div>
				</div>
				<!-- Affiliates Tab -->
				<div id="adminAffiliatesTab" class="admin-tab-content">
					<div class="d-flex justify-content-between align-items-center mb-4">
						<h5>Gestión de Afiliados</h5>
						<button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addAffiliateModal">
							<i class="fas fa-plus"></i> Agregar Afiliado
						</button>
					</div>
					<div class="table-responsive">
						<table class="table table-striped table-hover">
							<thead>
								<tr>
									<th>ID</th>
									<th>Nombre</th>
									<th>Email</th>
									<th>Tienda</th>
									<th>Comisión</th>
									<th>Ventas</th>
									<th>Estado</th>
									<th>Acciones</th>
								</tr>
							</thead>
							<tbody id="adminAffiliatesTable">
								<!-- Affiliates will be loaded here -->
							</tbody>
						</table>
					</div>
				</div>
				<!-- Orders Tab -->
				<div id="adminOrdersTab" class="admin-tab-content">
					<h5 class="mb-4">Gestión de Pedidos</h5>
					<div class="table-responsive">
						<table class="table table-striped table-hover">
							<thead>
								<tr>
									<th>ID</th>
									<th>Cliente</th>
									<th>Tienda</th>
									<th>Fecha</th>
									<th>Total</th>
									<th>Estado</th>
									<th>Acciones</th>
								</tr>
							</thead>
							<tbody id="adminOrdersTable">
								<!-- Orders will be loaded here -->
							</tbody>
						</table>
					</div>
				</div>
				<!-- Reports Tab -->
				<div id="adminReportsTab" class="admin-tab-content">
					<h5 class="mb-4">Generación de Reportes</h5>
					<div class="row mb-4">
						<div class="col-md-4">
							<div class="card">
								<div class="card-body text-center">
									<h5 class="card-title">Reporte de Ventas</h5>
									<p class="card-text">Genera un reporte detallado de ventas por período</p>
									<button class="btn btn-primary" onclick="generateReport('sales')">
										<i class="fas fa-download"></i> Generar
									</button>
								</div>
							</div>
						</div>
						<div class="col-md-4">
							<div class="card">
								<div class="card-body text-center">
									<h5 class="card-title">Reporte de Productos</h5>
									<p class="card-text">Reporte de productos más vendidos y stock</p>
									<button class="btn btn-primary" onclick="generateReport('products')">
										<i class="fas fa-download"></i> Generar
									</button>
								</div>
							</div>
						</div>
						<div class="col-md-4">
							<div class="card">
								<div class="card-body text-center">
									<h5 class="card-title">Reporte de Afiliados</h5>
									<p class="card-text">Comisiones y desempeño de afiliados</p>
									<button class="btn btn-primary" onclick="generateReport('affiliates')">
										<i class="fas fa-download"></i> Generar
									</button>
								</div>
							</div>
						</div>
					</div>
					<div class="card">
						<div class="card-header">
							<h6>Reporte Personalizado</h6>
						</div>
						<div class="card-body">
							<form id="customReportForm">
								<div class="row mb-3">
									<div class="col-md-4">
										<label class="form-label">Tipo de Reporte</label>
										<select class="form-select" id="reportType">
											<option value="sales">Ventas</option>
											<option value="products">Productos</option>
											<option value="customers">Clientes</option>
											<option value="affiliates">Afiliados</option>
										</select>
									</div>
									<div class="col-md-4">
										<label class="form-label">Fecha Inicio</label>
										<input type="date" class="form-control" id="reportStartDate">
									</div>
									<div class="col-md-4">
										<label class="form-label">Fecha Fin</label>
										<input type="date" class="form-control" id="reportEndDate">
									</div>
								</div>
								<button type="submit" class="btn btn-primary">
									<i class="fas fa-download"></i> Generar Reporte Personalizado
								</button>
							</form>
						</div>
					</div>
				</div>
				<!-- Imports Tab -->
				<div id="adminImportsTab" class="admin-tab-content">
					<h5 class="mb-4">Importar Datos</h5>
					<div class="import-section">
						<h6><i class="fas fa-store"></i> Importar Tiendas</h6>
						<p>Importa tiendas desde un archivo Excel (.xlsx). El archivo debe tener las columnas: Nombre, Categoría, Administrador, Email, Teléfono.</p>
						<div class="input-group mb-3">
							<input type="file" class="form-control" id="storesFile" accept=".xlsx">
							<button class="btn btn-primary" type="button" onclick="importStores()">
								<i class="fas fa-upload"></i> Importar Tiendas
							</button>
						</div>
					</div>
					<div class="import-section">
						<h6><i class="fas fa-box"></i> Importar Productos</h6>
						<p>Importa productos desde un archivo Excel (.xlsx). El archivo debe tener las columnas: Nombre, Tienda, Categoría, Precio1, Precio2, Precio3, Stock, Descripción.</p>
						<div class="input-group mb-3">
							<input type="file" class="form-control" id="productsFile" accept=".xlsx">
							<button class="btn btn-primary" type="button" onclick="importProducts()">
								<i class="fas fa-upload"></i> Importar Productos
							</button>
						</div>
					</div>
					<div class="import-section">
						<h6><i class="fas fa-tags"></i> Importar Categorías</h6>
						<p>Importa categorías desde un archivo Excel (.xlsx). El archivo debe tener las columnas: Nombre, Descripción.</p>
						<div class="input-group mb-3">
							<input type="file" class="form-control" id="categoriesFile" accept=".xlsx">
							<button class="btn btn-primary" type="button" onclick="importCategories()">
								<i class="fas fa-upload"></i> Importar Categorías
							</button>
						</div>
					</div>
					<div class="import-section">
						<h6><i class="fas fa-users"></i> Importar Clientes</h6>
						<p>Importa clientes desde un archivo Excel (.xlsx). El archivo debe tener las columnas: Nombre, Email, Teléfono, Dirección.</p>
						<div class="input-group mb-3">
							<input type="file" class="form-control" id="customersFile" accept=".xlsx">
							<button class="btn btn-primary" type="button" onclick="importCustomers()">
								<i class="fas fa-upload"></i> Importar Clientes
							</button>
						</div>
					</div>
					<div class="import-section">
						<h6><i class="fas fa-handshake"></i> Importar Afiliados</h6>
						<p>Importa afiliados desde un archivo Excel (.xlsx). El archivo debe tener las columnas: Nombre, Email, Comisión, Estado.</p>
						<div class="input-group mb-3">
							<input type="file" class="form-control" id="affiliatesFile" accept=".xlsx">
							<button class="btn btn-primary" type="button" onclick="importAffiliates()">
								<i class="fas fa-upload"></i> Importar Afiliados
							</button>
						</div>
					</div>
				</div>
				<!-- Commissions Tab -->
				<div id="adminCommissionsTab" class="admin-tab-content">
					<h5 class="mb-4">Gestión de Comisiones por Tienda</h5>
					<div class="table-responsive">
						<table class="table table-striped table-hover">
							<thead>
								<tr>
									<th>ID</th>
									<th>Tienda</th>
									<th>Comisión Global (%)</th>
									<th>Acciones</th>
								</tr>
							</thead>
							<tbody id="adminCommissionsTable">
								<!-- Las comisiones se cargarán aquí -->
							</tbody>
						</table>
					</div>
				</div>
				<!-- Settings Tab -->
				<div id="adminSettingsTab" class="admin-tab-content">
					<h5 class="mb-4">Configuración de Cuenta</h5>
					<div class="row">
						<div class="col-md-6">
							<div class="card mb-4">
								<div class="card-header bg-primary text-white">
									<i class="fas fa-user"></i> Datos Personales
								</div>
								<div class="card-body">
									<form id="ownerDataForm">
										<div class="mb-3">
											<label for="ownerName" class="form-label">Nombre</label>
											<input type="text" class="form-control" id="ownerName" value="Propietario PaTí">
										</div>
										<div class="mb-3">
											<label for="ownerEmail" class="form-label">Correo electrónico</label>
											<input type="email" class="form-control" id="ownerEmail" value="propietario@pati.com">
										</div>
										<div class="mb-3">
											<label for="ownerPhone" class="form-label">Teléfono</label>
											<input type="tel" class="form-control" id="ownerPhone" value="(123) 456-7890">
										</div>
										<button type="submit" class="btn btn-primary">Actualizar Datos</button>
									</form>
								</div>
							</div>
						</div>
						<div class="col-md-6">
							<div class="card mb-4">
								<div class="card-header bg-warning text-dark">
									<i class="fas fa-lock"></i> Cambiar Contraseña
								</div>
								<div class="card-body">
									<form id="ownerPasswordForm">
										<div class="mb-3">
											<label for="currentPassword" class="form-label">Contraseña Actual</label>
											<input type="password" class="form-control" id="currentPassword" required>
										</div>
										<div class="mb-3">
											<label for="newPassword" class="form-label">Nueva Contraseña</label>
											<input type="password" class="form-control" id="newPassword" required>
										</div>
										<div class="mb-3">
											<label for="confirmNewPassword" class="form-label">Confirmar Nueva Contraseña</label>
											<input type="password" class="form-control" id="confirmNewPassword" required>
										</div>
										<button type="submit" class="btn btn-warning">Cambiar Contraseña</button>
									</form>
								</div>
							</div>
						</div>
					</div>
					<div class="card">
						<div class="card-header bg-info text-white">
							<i class="fas fa-cogs"></i> Configuración de Contacto
						</div>
						<div class="card-body">
							<form id="contactSettingsForm">
								<div class="row">
									<div class="col-md-6">
										<div class="mb-3">
											<label for="contactAddress" class="form-label">Dirección</label>
											<input type="text" class="form-control" id="contactAddress" value="Av. Principal #123, Ciudad">
										</div>
									</div>
									<div class="col-md-6">
										<div class="mb-3">
											<label for="contactPhone" class="form-label">Teléfono de Contacto</label>
											<input type="tel" class="form-control" id="contactPhone" value="(123) 456-7890">
										</div>
									</div>
								</div>
								<div class="row">
									<div class="col-md-6">
										<div class="mb-3">
											<label for="contactEmail" class="form-label">Correo de Contacto</label>
											<input type="email" class="form-control" id="contactEmail" value="info@pati.com">
										</div>
									</div>
									<div class="col-md-6">
										<div class="mb-3">
											<label for="contactHours" class="form-label">Horario de Atención</label>
											<input type="text" class="form-control" id="contactHours" value="Lunes a Sábado: 9:00 am - 8:00 pm">
										</div>
									</div>
								</div>
								<button type="submit" class="btn btn-info">Actualizar Configuración</button>
							</form>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
    <!-- Shopping Cart -->
    <div class="cart-icon" data-bs-toggle="offcanvas" data-bs-target="#cartOffcanvas">
        <i class="fas fa-shopping-cart fa-lg"></i>
        <span class="cart-badge" id="cartCount">0</span>
    </div>
    <!-- Cart Offcanvas -->
    <div class="offcanvas offcanvas-end" tabindex="-1" id="cartOffcanvas">
        <div class="offcanvas-header">
            <h5 class="offcanvas-title">Carrito de Compras</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas"></button>
        </div>
        <div class="offcanvas-body">
            <div id="cartItems">
                <!-- Cart items will be loaded here -->
            </div>
            <div class="mt-3">
                <h5>Total: <span id="cartTotal">$0.00</span></h5>
                <button class="btn btn-primary w-100 mt-3" onclick="checkout()">Realizar Pedido</button>
            </div>
        </div>
    </div>
    <!-- Add Store Modal -->
    <div class="modal fade" id="addStoreModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Agregar Tienda</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="addStoreForm">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="newStoreName" class="form-label">Nombre de la Tienda</label>
                                    <input type="text" class="form-control" id="newStoreName" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="newStoreCategory" class="form-label">Categoría Principal</label>
                                    <select class="form-select" id="newStoreCategory" required>
                                        <option value="">Seleccionar categoría</option>
                                        <option value="C001">Electrónica</option>
                                        <option value="C002">Hogar</option>
                                        <option value="C003">Útiles y Herramientas</option>
                                        <option value="C004">Ropas</option>
                                        <option value="C005">Calzados</option>
                                        <option value="C006">Deportiva</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="newAdminName" class="form-label">Nombre del Administrador</label>
                                    <input type="text" class="form-control" id="newAdminName" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="newAdminEmail" class="form-label">Correo del Administrador</label>
                                    <input type="email" class="form-control" id="newAdminEmail" required>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="newAdminPassword" class="form-label">Contraseña</label>
                                    <input type="password" class="form-control" id="newAdminPassword" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="newAdminPhone" class="form-label">Teléfono</label>
                                    <input type="tel" class="form-control" id="newAdminPhone" required>
                                </div>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="newStoreDescription" class="form-label">Descripción de la Tienda</label>
                            <textarea class="form-control" id="newStoreDescription" rows="3" required></textarea>
                        </div>
                        <div class="mb-3">
                            <label for="newStoreImage" class="form-label">URL de Imagen Representativa</label>
                            <input type="url" class="form-control" id="newStoreImage">
                        </div>
                        <div class="mb-3">
                            <label for="newStoreLogo" class="form-label">URL del Logo de la Tienda (opcional)</label>
                            <input type="url" class="form-control" id="newStoreLogo">
                        </div>
                        <button type="submit" class="btn btn-primary">Crear Tienda</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
    <!-- Add Product Modal -->
    <div class="modal fade" id="addProductModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Agregar Producto</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="addProductForm">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="productName" class="form-label">Nombre</label>
                                    <input type="text" class="form-control" id="productName" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="productStore" class="form-label">Tienda</label>
                                    <select class="form-select" id="productStore" required>
                                        <option value="">Seleccionar tienda</option>
                                        <!-- Stores will be loaded here -->
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="productCategory" class="form-label">Categoría</label>
                                    <select class="form-select" id="productCategory" required>
                                        <option value="">Seleccionar categoría</option>
                                        <option value="C001">Electrónica</option>
                                        <option value="C002">Hogar</option>
                                        <option value="C003">Útiles y Herramientas</option>
                                        <option value="C004">Ropas</option>
                                        <option value="C005">Calzados</option>
                                        <option value="C006">Deportiva</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="productStock" class="form-label">Stock</label>
                                    <input type="number" class="form-control" id="productStock" required>
                                </div>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Precios por Cantidad</label>
                            <div class="row">
                                <div class="col-md-4">
                                    <div class="input-group mb-3">
                                        <span class="input-group-text">1-10</span>
                                        <input type="number" step="0.01" class="form-control" id="productPrice1" placeholder="Precio" required>
                                        <span class="input-group-text">USD</span>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="input-group mb-3">
                                        <span class="input-group-text">11-50</span>
                                        <input type="number" step="0.01" class="form-control" id="productPrice2" placeholder="Precio" required>
                                        <span class="input-group-text">USD</span>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="input-group mb-3">
                                        <span class="input-group-text">51+</span>
                                        <input type="number" step="0.01" class="form-control" id="productPrice3" placeholder="Precio" required>
                                        <span class="input-group-text">USD</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="productDescription" class="form-label">Descripción</label>
                            <textarea class="form-control" id="productDescription" rows="3"></textarea>
                        </div>
                        <div class="mb-3">
                            <label for="productImage" class="form-label">Imagen URL</label>
                            <input type="url" class="form-control" id="productImage">
                        </div>
                        <button type="submit" class="btn btn-primary">Guardar Producto</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
    <!-- Edit Commission Modal -->
    <div class="modal fade" id="editCommissionModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Editar Comisión</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="editCommissionForm">
                        <input type="hidden" id="editCommissionId">
                        <div class="mb-3">
                            <label for="editCommissionStore" class="form-label">Tienda</label>
                            <input type="text" class="form-control" id="editCommissionStore" readonly>
                        </div>
                        <div class="mb-3">
                            <label for="editCommissionValue" class="form-label">Comisión (%)</label>
                            <input type="number" class="form-control" id="editCommissionValue" min="0" max="100" step="0.1" required>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-primary" onclick="saveCommission()">Guardar Cambios</button>
                </div>
            </div>
        </div>
    </div>
    <!-- Add Category Modal -->
    <div class="modal fade" id="addCategoryModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Agregar Categoría</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="addCategoryForm">
                        <div class="mb-3">
                            <label for="categoryName" class="form-label">Nombre</label>
                            <input type="text" class="form-control" id="categoryName" required>
                        </div>
                        <div class="mb-3">
                            <label for="categoryDescription" class="form-label">Descripción</label>
                            <textarea class="form-control" id="categoryDescription" rows="3"></textarea>
                        </div>
                        <button type="submit" class="btn btn-primary">Guardar Categoría</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
    <!-- Add Affiliate Modal -->
    <div class="modal fade" id="addAffiliateModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Agregar Afiliado</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="addAffiliateForm">
                        <div class="mb-3">
                            <label for="affiliateStore" class="form-label">Tienda</label>
                            <select class="form-select" id="affiliateStore" required>
                                <option value="">Seleccionar tienda</option>
                                <!-- Stores will be loaded here -->
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="affiliateName" class="form-label">Nombre</label>
                            <input type="text" class="form-control" id="affiliateName" required>
                        </div>
                        <div class="mb-3">
                            <label for="affiliateEmail" class="form-label">Email</label>
                            <input type="email" class="form-control" id="affiliateEmail" required>
                        </div>
                        <div class="mb-3">
                            <label for="affiliateCommission" class="form-label">Comisión (%)</label>
                            <input type="number" class="form-control" id="affiliateCommission" min="0" max="100" step="0.1" required>
                        </div>
                        <div class="mb-3">
                            <label for="affiliateStatus" class="form-label">Estado</label>
                            <select class="form-select" id="affiliateStatus" required>
                                <option value="Activo">Activo</option>
                                <option value="Inactivo">Inactivo</option>
                            </select>
                        </div>
                        <button type="submit" class="btn btn-primary">Guardar Afiliado</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/pocketbase@0.21.1/dist/pocketbase.umd.js"></script>
<script src="js/app.js"></script>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
       // ====== CONEXIÓN A POCKETBASE REAL ======
		const PB_URL = 'https://pati-platform.onrender.com';  // ← TU BACKEND REAL
		const pb = new PocketBase(PB_URL);

		// Datos REALES desde PocketBase
		let stores = [];
		let products = [];
		let categories = [];
		let customers = [];
		let affiliates = [];
		let orders = [];
        let cart = [];
        let currentUser = null;
        let isAdminLoggedIn = false;
        let currentStoreId = null;
        // Initialize the application
       document.addEventListener('DOMContentLoaded', async function() {
			setupEventListeners();
			initializeCharts();
			
			// Cargar datos REALES desde PocketBase
			console.log('📱 Iniciando PaTí...');
			await loadRealData();
			console.log('🚀 Aplicación lista!');
		});
		// Función para cargar datos REALES desde PocketBase
		async function loadRealData() {
			try {
				console.log('🔄 Cargando datos desde PocketBase...');
				
				// 1. Cargar categorías
				try {
					const categoriesResult = await pb.collection('categories').getList(1, 50);
					categories = categoriesResult.items.map(item => ({
						id: item.id,
						name: item.name,
						description: item.description || ''
					}));
					console.log(`✅ Categorías cargadas: ${categories.length}`);
				} catch (error) {
					console.warn('⚠️ No se pudieron cargar categorías, usando datos de ejemplo');
					categories = [
						{ id: 'C001', name: 'Electrónica', description: '' },
						{ id: 'C002', name: 'Hogar', description: '' },
						{ id: 'C003', name: 'Útiles y Herramientas', description: '' },
						{ id: 'C004', name: 'Ropas', description: '' },
						{ id: 'C005', name: 'Calzados', description: '' },
						{ id: 'C006', name: 'Deportiva', description: '' }
					];
				}
				
				// 2. Cargar tiendas
				try {
					const storesResult = await pb.collection('stores').getList(1, 50);
					stores = storesResult.items.map(item => ({
						id: item.id,
						name: item.name,
						categoryId: item.category || 'C001',
						admin: item.admin_email || 'admin@tienda.com',
						status: item.status || 'Activo',
						image: item.image || 'https://images.unsplash.com/photo-1607082348824-0a96f2a4b9da?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80',
						description: item.description || 'Tienda en línea'
					}));
					console.log(`✅ Tiendas cargadas: ${stores.length}`);
				} catch (error) {
					console.warn('⚠️ No se pudieron cargar tiendas, usando datos de ejemplo');
					stores = [
						{ id: 1, name: "TechZone", categoryId: 'C001', admin: "admin@techzone.com", status: "Activo", image: "https://images.unsplash.com/photo-1561154464-82e9adf32764?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80", description: "La mejor tecnología" },
						{ id: 2, name: "FashionStyle", categoryId: 'C004', admin: "admin@fashionstyle.com", status: "Activo", image: "https://images.unsplash.com/photo-1521572163474-6864f9cf17ab?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80", description: "Moda para todos" }
					];
				}
				
				// 3. Cargar productos
				try {
					const productsResult = await pb.collection('products').getList(1, 200);
					products = productsResult.items.map(item => ({
						id: item.id,
						name: item.name,
						store: item.store_name || 'Tienda General',
						storeId: item.store || 1,
						categoryId: item.category || 'C001',
						price1: parseFloat(item.price1) || 0,
						price2: parseFloat(item.price2) || 0,
						price3: parseFloat(item.price3) || 0,
						stock: parseInt(item.stock) || 0,
						image: item.image || 'https://images.unsplash.com/photo-1505740420928-5e560c06d30e?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80',
						description: item.description || ''
					}));
					console.log(`✅ Productos cargados: ${products.length}`);
				} catch (error) {
					console.warn('⚠️ No se pudieron cargar productos, usando datos de ejemplo');
					products = [
						{ id: 1, name: "Smartphone XYZ", store: "TechZone", storeId: 1, categoryId: 'C001', price1: 299.99, price2: 279.99, price3: 259.99, stock: 15, image: "https://images.unsplash.com/photo-1511707171634-5f897ff02aa9?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80", description: "Smartphone de última generación." }
					];
				}
				
				console.log('✅ Datos REALES cargados desde PocketBase');
				
				// Actualizar UI
				if (typeof loadFeaturedStores === 'function') loadFeaturedStores();
				if (typeof loadProducts === 'function') loadProducts();
				
			} catch (error) {
				console.error('❌ Error grave cargando datos:', error);
				alert('Error conectando con el servidor. Usando datos de ejemplo.');
			}
		}	
        function setupEventListeners() {
            // Admin login form
            const adminLoginForm = document.getElementById('adminLoginForm');
            if (adminLoginForm) {
                adminLoginForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    adminLogin();
                });
            }
            // Login form
            document.getElementById('loginForm').addEventListener('submit', function(e) {
                e.preventDefault();
                userLogin();
            });
            // Register form
            document.getElementById('registerForm').addEventListener('submit', function(e) {
                e.preventDefault();
                userRegister();
            });
            // Add store form
            document.getElementById('addStoreForm').addEventListener('submit', function(e) {
                e.preventDefault();
                addStore();
            });
            // Create store form
            document.getElementById('createStoreForm').addEventListener('submit', function(e) {
                e.preventDefault();
                createStore();
            });
            // Add product form
            document.getElementById('addProductForm').addEventListener('submit', function(e) {
                e.preventDefault();
                addProduct();
            });
            // Add category form
            document.getElementById('addCategoryForm').addEventListener('submit', function(e) {
                e.preventDefault();
                addCategory();
            });
            // Add affiliate form
            document.getElementById('addAffiliateForm').addEventListener('submit', function(e) {
                e.preventDefault();
                addAffiliate();
            });
            // Contact form
            document.getElementById('contactForm').addEventListener('submit', function(e) {
                e.preventDefault();
                alert('¡Gracias por tu mensaje! Te contactaremos pronto.');
                e.target.reset();
            });
            // Owner data form
            document.getElementById('ownerDataForm').addEventListener('submit', function(e) {
                e.preventDefault();
                alert('Datos actualizados correctamente');
            });
            // Owner password form
            document.getElementById('ownerPasswordForm').addEventListener('submit', function(e) {
                e.preventDefault();
                const newPassword = document.getElementById('newPassword').value;
                const confirmPassword = document.getElementById('confirmNewPassword').value;
                if (newPassword !== confirmPassword) {
                    alert('Las contraseñas no coinciden');
                    return;
                }
                alert('Contraseña cambiada correctamente');
                e.target.reset();
            });
            // Contact settings form
            document.getElementById('contactSettingsForm').addEventListener('submit', function(e) {
                e.preventDefault();
                alert('Configuración de contacto actualizada correctamente');
            });
            // Custom report form
            document.getElementById('customReportForm').addEventListener('submit', function(e) {
                e.preventDefault();
                generateCustomReport();
            });
            // Register role change
            document.getElementById('registerRole').addEventListener('change', function() {
                const role = this.value;
                const affiliateFields = document.getElementById('affiliateFields');
                if (role === 'affiliate') {
                    affiliateFields.style.display = 'block';
                } else {
                    affiliateFields.style.display = 'none';
                }
            });
        }
        function showSection(section) {
			// Hide all sections
			document.getElementById('homeSection').style.display = 'none';
			document.getElementById('productsSection').style.display = 'none';
			document.getElementById('aboutSection').style.display = 'none';
			document.getElementById('contactSection').style.display = 'none';
			document.getElementById('storeSelectionSection').style.display = 'none';
			document.getElementById('createStoreSection').style.display = 'none';
			document.getElementById('storeLoginSection').style.display = 'none';
			
			// Show the selected section
			const sectionElement = document.getElementById(section + 'Section');
			if (sectionElement) {
				sectionElement.style.display = 'block';
			}
			
			// If products section, configure advanced filters
			if (section === 'products') {
				// Mostrar filtro de tiendas solo si estamos en la plataforma principal (no en una tienda específica)
				const storeFilterContainer = document.getElementById('storeFilterContainer');
				const storeFilter = document.getElementById('storeFilter');
				
				if (currentUser && currentUser.role !== 'customer' && currentUser.storeId) {
					// Estamos en una tienda específica, ocultar filtro de tiendas
					storeFilterContainer.style.display = 'none';
				} else {
					// Estamos en la plataforma principal, mostrar filtro de tiendas
					storeFilterContainer.style.display = 'block';
					
					// Llenar el select de tiendas
					if (storeFilter) {
						storeFilter.innerHTML = '<option value="">Todas las tiendas</option>';
						stores.forEach(store => {
							if (store.status === 'Activo') {
								const option = document.createElement('option');
								option.value = store.id;
								option.textContent = store.name;
								storeFilter.appendChild(option);
							}
						});
					}
				}
				
				loadProducts();
				filterProductsAdvanced(); // Usar el filtro avanzado
			}
		}
        function viewSite() {
            document.getElementById('adminPanel').classList.add('d-none');
            document.getElementById('mainContent').classList.remove('d-none');
            showSection('home');
        }
        function showStoreSelection() {
            showSection('storeSelection');
            loadStores();
        }
        function showCreateStoreForm() {
            showSection('createStore');
        }
        function showStoreLogin(storeId) {
            currentStoreId = storeId;
            const store = stores.find(s => s.id === storeId);
            if (store) {
                const storeLoginNameElement = document.getElementById('storeLoginName');
                if (storeLoginNameElement) {
                    storeLoginNameElement.textContent = store.name;
                }
            }
            showSection('storeLogin');
        }
        function showLoginForm(role = 'customer') {
            document.getElementById('loginRole').value = role;
            document.getElementById('loginStoreId').value = currentStoreId;
            const loginModal = new bootstrap.Modal(document.getElementById('loginModal'));
            loginModal.show();
        }
        function showRegisterForm(role = 'customer') {
            document.getElementById('registerRole').value = role;
            document.getElementById('registerStoreId').value = currentStoreId;
            const affiliateFields = document.getElementById('affiliateFields');
            if (role === 'affiliate') {
                affiliateFields.style.display = 'block';
            } else {
                affiliateFields.style.display = 'none'; 
            }
            const registerModal = new bootstrap.Modal(document.getElementById('registerModal'));
            registerModal.show();
        }
        function showAdminLogin() {
			const adminLoginModal = document.getElementById('adminLoginModal');
			if (adminLoginModal) {
				const modal = new bootstrap.Modal(adminLoginModal);
				modal.show();
			}
		}
        function loadFeaturedStores() {
            const featuredStores = document.getElementById('featuredStores');
            featuredStores.innerHTML = '';
            const selected = stores.slice(0, 4);
            selected.forEach(store => {
                const storeCard = `
                    <div class="col-md-6 col-lg-3 mb-4">
                        <div class="card store-card h-100">
                            <img src="${store.image}" class="card-img-top" alt="${store.name}" style="height: 180px; object-fit: cover;">
                            <div class="card-body d-flex flex-column">
                                <h5 class="card-title">${store.name}</h5>
                                <p class="card-text flex-grow-1">${store.description}</p>
                                <div class="d-flex justify-content-between align-items-center">
                                    <span class="store-status ${store.status === 'Activo' ? 'status-active' : 'status-inactive'}">${store.status}</span>
                                    <button class="btn btn-primary" onclick="showStoreLogin(${store.id})">
                                        <i class="fas fa-sign-in-alt"></i> Entrar
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                featuredStores.innerHTML += storeCard;
            });
        }
        function loadStores() {
            const storesList = document.getElementById('storesList');
            storesList.innerHTML = '';
            stores.forEach(store => {
                const category = categories.find(c => c.id === store.categoryId)?.name || 'Sin categoría';
                const storeCard = `
                    <div class="col-md-6 col-lg-4 mb-4">
                        <div class="card store-card h-100">
                            <img src="${store.image}" class="card-img-top" alt="${store.name}" style="height: 180px; object-fit: cover;">
                            <div class="card-body d-flex flex-column">
                                <h5 class="card-title">${store.name}</h5>
                                <p class="card-text flex-grow-1">${category}</p>
                                <p>${store.description || ''}</p>
                                <div class="d-flex justify-content-between align-items-center">
                                    <span class="store-status ${store.status === 'Activo' ? 'status-active' : 'status-inactive'}">${store.status}</span>
                                    <button class="btn btn-primary" onclick="showStoreLogin(${store.id})">
                                        <i class="fas fa-sign-in-alt"></i> Entrar
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                storesList.innerHTML += storeCard;
            });
        }
        function filterStores() {
            const searchText = document.getElementById('searchStore').value.toLowerCase();
            const categoryFilter = document.getElementById('categoryStoreFilter').value;
            const filteredStores = stores.filter(store => {
                const matchesSearch = store.name.toLowerCase().includes(searchText) || 
                                    store.description.toLowerCase().includes(searchText);
                const matchesCategory = categoryFilter === '' || store.categoryId === categoryFilter;
                return matchesSearch && matchesCategory;
            });
            const storesList = document.getElementById('storesList');
            storesList.innerHTML = '';
            filteredStores.forEach(store => {
                const category = categories.find(c => c.id === store.categoryId)?.name || 'Sin categoría';
                const storeCard = `
                    <div class="col-md-6 col-lg-4 mb-4">
                        <div class="card store-card h-100">
                            <img src="${store.image}" class="card-img-top" alt="${store.name}" style="height: 180px; object-fit: cover;">
                            <div class="card-body d-flex flex-column">
                                <h5 class="card-title">${store.name}</h5>
                                <p class="card-text flex-grow-1">${category}</p>
                                <p>${store.description || ''}</p>
                                <div class="d-flex justify-content-between align-items-center">
                                    <span class="store-status ${store.status === 'Activo' ? 'status-active' : 'status-inactive'}">${store.status}</span>
                                    <button class="btn btn-primary" onclick="showStoreLogin(${store.id})">
                                        <i class="fas fa-sign-in-alt"></i> Entrar
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                storesList.innerHTML += storeCard;
            });
        }
        function loadProducts() {
            const productsList = document.getElementById('productsList');
            productsList.innerHTML = '';
            products.forEach(product => {
                const category = categories.find(c => c.id === product.categoryId)?.name || 'Sin categoría';
                const productCard = `
                    <div class="col-md-6 col-lg-4 col-xl-3 mb-4">
                        <div class="card product-card h-100">
                            <span class="category-badge badge bg-primary">${category}</span>
                            <img src="${product.image}" class="card-img-top product-image" alt="${product.name}">
                            <div class="card-body d-flex flex-column">
                                <h5 class="card-title">${product.name}</h5>
                                <p class="card-text flex-grow-1">${product.description}</p>
                                <div class="price-tier">
                                    <span>1-10: </span><span>$${product.price1.toFixed(2)}</span>
                                </div>
                                <div class="price-tier">
                                    <span>11-50: </span><span>$${product.price2.toFixed(2)}</span>
                                </div>
                                <div class="price-tier">
                                    <span>51+: </span><span>$${product.price3.toFixed(2)}</span>
                                </div>
                                <div class="quantity-control">
                                    <button type="button" onclick="decreaseQuantity(${product.id})">-</button>
                                    <input type="number" id="quantity-${product.id}" value="0" min="0" readonly>
                                    <button type="button" onclick="increaseQuantity(${product.id})">+</button>
                                </div>
                                <button class="btn btn-primary mt-2 w-100" onclick="addToCart(${product.id})">
                                    <i class="fas fa-cart-plus"></i> Agregar
                                </button>
                            </div>
                        </div>
                    </div>
                `;
                productsList.innerHTML += productCard;
            });
        }
        function filterProducts() {
            const searchText = document.getElementById('searchProduct').value.toLowerCase();
            const categoryFilter = document.getElementById('categoryFilter').value;
            const filteredProducts = products.filter(product => {
                const matchesSearch = product.name.toLowerCase().includes(searchText) || 
                                    product.description.toLowerCase().includes(searchText);
                const matchesCategory = categoryFilter === '' || product.categoryId === categoryFilter;
                return matchesSearch && matchesCategory;
            });
            const productsList = document.getElementById('productsList');
            productsList.innerHTML = '';
            filteredProducts.forEach(product => {
                const category = categories.find(c => c.id === product.categoryId)?.name || 'Sin categoría';
                const productCard = `
                    <div class="col-md-6 col-lg-4 col-xl-3 mb-4">
                        <div class="card product-card h-100">
                            <span class="category-badge badge bg-primary">${category}</span>
                            <img src="${product.image}" class="card-img-top product-image" alt="${product.name}">
                            <div class="card-body d-flex flex-column">
                                <h5 class="card-title">${product.name}</h5>
                                <p class="card-text flex-grow-1">${product.description}</p>
                                <div class="price-tier">
                                    <span>1-10: </span><span>$${product.price1.toFixed(2)}</span>
                                </div>
                                <div class="price-tier">
                                    <span>11-50: </span><span>$${product.price2.toFixed(2)}</span>
                                </div>
                                <div class="price-tier">
                                    <span>51+: </span><span>$${product.price3.toFixed(2)}</span>
                                </div>
                                <div class="quantity-control">
                                    <button type="button" onclick="decreaseQuantity(${product.id})">-</button>
                                    <input type="number" id="quantity-${product.id}" value="0" min="0" readonly>
                                    <button type="button" onclick="increaseQuantity(${product.id})">+</button>
                                </div>
                                <button class="btn btn-primary mt-2 w-100" onclick="addToCart(${product.id})">
                                    <i class="fas fa-cart-plus"></i> Agregar
                                </button>
                            </div>
                        </div>
                    </div>
                `;
                productsList.innerHTML += productCard;
            });
        }
		function filterProductsAdvanced() {
			const searchText = document.getElementById('searchProduct').value.toLowerCase();
			const categoryFilter = document.getElementById('categoryFilter').value;
			const storeFilter = document.getElementById('storeFilter') ? document.getElementById('storeFilter').value : '';
			const priceMin = parseFloat(document.getElementById('priceMin').value) || 0;
			const priceMax = parseFloat(document.getElementById('priceMax').value) || Infinity;
			
			const filteredProducts = products.filter(product => {
				// Filtro por texto de búsqueda
				const matchesSearch = searchText === '' || 
									 product.name.toLowerCase().includes(searchText) || 
									 product.description.toLowerCase().includes(searchText);
				
				// Filtro por categoría
				const matchesCategory = categoryFilter === '' || product.categoryId === categoryFilter;
				
				// Filtro por tienda
				const matchesStore = storeFilter === '' || product.storeId === parseInt(storeFilter);
				
				// Filtro por rango de precios
				const productPrice = product.price1; // Usamos el precio base para filtrar
				const matchesPrice = productPrice >= priceMin && productPrice <= priceMax;
				
				return matchesSearch && matchesCategory && matchesStore && matchesPrice;
			});
			
			displayFilteredProducts(filteredProducts);
		}

		function displayFilteredProducts(filteredProducts) {
			const productsList = document.getElementById('productsList');
			productsList.innerHTML = '';
			
			if (filteredProducts.length === 0) {
				productsList.innerHTML = `
					<div class="col-12 text-center py-5">
						<i class="fas fa-search fa-3x text-muted mb-3"></i>
						<h4>No se encontraron productos</h4>
						<p>Intenta con otros filtros de búsqueda</p>
					</div>
				`;
				return;
			}
			
			filteredProducts.forEach(product => {
				const category = categories.find(c => c.id === product.categoryId)?.name || 'Sin categoría';
				const productCard = `
					<div class="col-md-6 col-lg-4 col-xl-3 mb-4">
						<div class="card product-card h-100">
							<span class="category-badge badge bg-primary">${category}</span>
							<img src="${product.image}" class="card-img-top product-image" alt="${product.name}">
							<div class="card-body d-flex flex-column">
								<h5 class="card-title">${product.name}</h5>
								<p class="card-text flex-grow-1">${product.description}</p>
								<div class="price-tier">
									<span>1-10: </span><span>$${product.price1.toFixed(2)}</span>
								</div>
								<div class="price-tier">
									<span>11-50: </span><span>$${product.price2.toFixed(2)}</span>
								</div>
								<div class="price-tier">
									<span>51+: </span><span>$${product.price3.toFixed(2)}</span>
								</div>
								<div class="quantity-control">
									<button type="button" onclick="decreaseQuantity(${product.id})">-</button>
									<input type="number" id="quantity-${product.id}" value="0" min="0" readonly>
									<button type="button" onclick="increaseQuantity(${product.id})">+</button>
								</div>
								<button class="btn btn-primary mt-2 w-100" onclick="addToCart(${product.id})">
									<i class="fas fa-cart-plus"></i> Agregar
								</button>
							</div>
						</div>
					</div>
				`;
				productsList.innerHTML += productCard;
			});
		}
        function increaseQuantity(productId) {
            const quantityInput = document.getElementById(`quantity-${productId}`);
            const currentValue = parseInt(quantityInput.value);
            quantityInput.value = currentValue + 1;
        }
        function decreaseQuantity(productId) {
            const quantityInput = document.getElementById(`quantity-${productId}`);
            const currentValue = parseInt(quantityInput.value);
            if (currentValue > 0) {
                quantityInput.value = currentValue - 1;
            }
        }
        function addToCart(productId) {
            const product = products.find(p => p.id === productId);
            const quantity = parseInt(document.getElementById(`quantity-${productId}`).value);
            if (product && quantity > 0) {
                let price;
                if (quantity >= 51) {
                    price = product.price3;
                } else if (quantity >= 11) {
                    price = product.price2;
                } else {
                    price = product.price1;
                }
                const existingItem = cart.find(item => item.id === productId);
                if (existingItem) {
                    existingItem.quantity += quantity;
                } else {
                    cart.push({ 
                        ...product, 
                        quantity: quantity,
                        unitPrice: price
                    });
                }
                document.getElementById(`quantity-${productId}`).value = 0;
                updateCart();
                showNotification(`${product.name} agregado al carrito`);
            } else {
                alert('Por favor, selecciona una cantidad mayor a cero');
            }
        }
        function updateCart() {
            const cartCount = document.getElementById('cartCount');
            const cartItems = document.getElementById('cartItems');
            const cartTotal = document.getElementById('cartTotal');
            cartCount.textContent = cart.reduce((total, item) => total + item.quantity, 0);
            cartItems.innerHTML = '';
            let total = 0;
            cart.forEach(item => {
                const itemTotal = item.unitPrice * item.quantity;
                total += itemTotal;
                const cartItem = `
                    <div class="card mb-2">
                        <div class="card-body">
                            <div class="d-flex justify-content-between">
                                <div>
                                    <h6 class="my-0">${item.name}</h6>
                                    <small class="text-muted">$${item.unitPrice.toFixed(2)} x ${item.quantity}</small>
                                </div>
                                <div class="d-flex align-items-center">
                                    <span class="text-muted">$${itemTotal.toFixed(2)}</span>
                                    <button class="btn btn-sm btn-outline-danger ms-2" onclick="removeFromCart(${item.id})">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                cartItems.innerHTML += cartItem;
            });
            cartTotal.textContent = `$${total.toFixed(2)}`;
        }
        function removeFromCart(productId) {
            cart = cart.filter(item => item.id !== productId);
            updateCart();
        }
        function checkout() {
            if (cart.length === 0) {
                alert('Tu carrito está vacío. Agrega algunos productos antes de realizar el pedido.');
                return;
            }
            alert('¡Pedido realizado con éxito! Pronto nos comunicaremos contigo para coordinar la entrega.');
            cart = [];
            updateCart();
            const offcanvas = document.getElementById('cartOffcanvas');
            const bsOffcanvas = bootstrap.Offcanvas.getInstance(offcanvas);
            bsOffcanvas.hide();
        }
        function showNotification(message) {
            const notification = document.createElement('div');
            notification.className = 'position-fixed bottom-5 end-0 m-3 alert alert-success alert-dismissible fade show';
            notification.style.zIndex = '1050';
            notification.innerHTML = `
                ${message}
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            `;
            document.body.appendChild(notification);
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.parentNode.removeChild(notification);
                }
            }, 3000);
        }
        function userLogin() {
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            const role = document.getElementById('loginRole').value;
            const storeId = parseInt(document.getElementById('loginStoreId').value);
            if (email && password) {
                currentUser = {
                    id: Date.now(),
                    email,
                    role,
                    storeId
                };
                document.getElementById('authButtons').classList.add('d-none');
                document.getElementById('logoutButton').classList.remove('d-none');
                const loginModal = bootstrap.Modal.getInstance(document.getElementById('loginModal'));
                loginModal.hide();
                if (role === 'admin') {
                    isAdminLoggedIn = true;
                    document.getElementById('mainContent').classList.add('d-none');
                    document.getElementById('adminPanel').classList.remove('d-none');
                    loadAdminData();
                    showNotification('Has iniciado sesión como administrador de la tienda');
                } else {
                    showSection('products');
                    showNotification(`Has iniciado sesión como ${role}`);
                }
            } else {
                alert('Por favor, ingresa tus credenciales');
            }
        }
        function userRegister() {
            const name = document.getElementById('registerName').value;
            const email = document.getElementById('registerEmail').value;
            const password = document.getElementById('registerPassword').value;
            const confirmPassword = document.getElementById('registerConfirmPassword').value;
            const role = document.getElementById('registerRole').value;
            const storeId = parseInt(document.getElementById('registerStoreId').value);
            if (password !== confirmPassword) {
                alert('Las contraseñas no coinciden');
                return;
            }
            if (name && email && password) {
                currentUser = {
                    id: Date.now(),
                    name,
                    email,
                    role,
                    storeId
                };
                document.getElementById('authButtons').classList.add('d-none');
                document.getElementById('logoutButton').classList.remove('d-none');
                const registerModal = bootstrap.Modal.getInstance(document.getElementById('registerModal'));
                registerModal.hide();
                showSection('products');
                showNotification(`Tu cuenta ha sido creada correctamente. Has iniciado sesión como ${role}`);
            } else {
                alert('Por favor, completa todos los campos');
            }
        }
        // ✅ CORRECCIÓN: Función adminLogin mejorada
        function adminLogin() {
			const username = document.getElementById('adminUsername').value.trim();
			const password = document.getElementById('adminPassword').value.trim();
			if (username === 'propietario' && password === 'propietario123') {
				isAdminLoggedIn = true;
				currentUser = {
					id: 1, 
					name: 'Propietario',
					email: 'propietario@pati.com',
					role: 'propietario'
				};
				document.getElementById('mainContent').classList.add('d-none');
				document.getElementById('adminPanel').classList.remove('d-none');
				document.getElementById('authButtons').classList.add('d-none');
				document.getElementById('logoutButton').classList.remove('d-none');
				const modal = bootstrap.Modal.getInstance(document.getElementById('adminLoginModal'));
				if (modal) modal.hide();
				loadAdminData();
				showNotification('Has iniciado sesión como Propietario');
			} else {
				alert('Credenciales incorrectas');
			}
		}
        function logout() {
            currentUser = null;
            isAdminLoggedIn = false;
            currentStoreId = null;
            cart = [];
            updateCart();
            document.getElementById('mainContent').classList.remove('d-none');
            document.getElementById('adminPanel').classList.add('d-none');
            document.getElementById('authButtons').classList.add('d-none');
            document.getElementById('logoutButton').classList.add('d-none');
            showSection('home');
            showNotification('Has cerrado sesión correctamente');
        }
        function createStore() {
            const storeName = document.getElementById('storeName').value;
            const storeCategory = document.getElementById('storeCategory').value;
            const adminName = document.getElementById('adminName').value;
            const adminEmail = document.getElementById('adminEmail').value;
            const adminPassword = document.getElementById('adminPassword').value;
            const adminPhone = document.getElementById('adminPhone').value;
            const storeDescription = document.getElementById('storeDescription').value;
            const storeImage = document.getElementById('storeImage').value || 'https://images.unsplash.com/photo-1607082348824-0a96f2a4b9da?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80';
            const storeLogo = document.getElementById('storeLogo').value;
            const newId = stores.length > 0 ? Math.max(...stores.map(s => s.id)) + 1 : 1;
            stores.push({
                id: newId,
                name: storeName,
                categoryId: storeCategory,
                admin: adminEmail,
                status: "Activo",
                image: storeImage,
                logo: storeLogo,
                description: storeDescription
            });
            document.getElementById('createStoreForm').reset();
            alert(`Tienda "${storeName}" creada correctamente. El administrador ha sido notificado.`);
            showSection('home');
        }
        function showAdminTab(tabId) {
            const tabs = document.querySelectorAll('.admin-tab-content');
            tabs.forEach(tab => tab.style.display = 'none');
            const menuItems = document.querySelectorAll('.admin-menu-item');
            menuItems.forEach(item => item.classList.remove('active'));
            const selectedTab = document.getElementById(tabId);
            if (selectedTab) {
                selectedTab.style.display = 'block';
            }
            if (event && event.currentTarget) {
                event.currentTarget.classList.add('active');
            }
        }
        function loadAdminData() {
            const isOwner = currentUser && currentUser.role === 'propietario';
            const isAdmin = currentUser && currentUser.role === 'admin';
            const currentStoreId = isAdmin ? currentUser.storeId : null;
            // Filtrar datos SOLO para admin de tienda
            const filteredProducts = isOwner ? products : products.filter(p => p.storeId === currentStoreId);
            const filteredCustomers = isOwner ? customers : customers.filter(c => c.storeId === currentStoreId);
            const filteredAffiliates = isOwner ? affiliates : affiliates.filter(a => a.storeId === currentStoreId);
            const filteredOrders = isOwner ? orders : orders.filter(o => o.storeId === currentStoreId);
            // Cargar tablas
            if (isOwner) {
                loadAdminStores(); // Solo el propietario ve tiendas
            }
            loadAdminProducts(filteredProducts);
            loadAdminCategories();
            loadAdminCustomers(filteredCustomers);
            loadAdminAffiliates(filteredAffiliates);
            loadAdminOrders(filteredOrders);
            // Menú dinámico
            const menu = document.getElementById('adminMenu');
            if (isOwner) {
				menu.innerHTML = `
					<div class="admin-menu-item active" onclick="showAdminTab('adminDashboardTab')">
						<i class="fas fa-tachometer-alt"></i> Dashboard
					</div>
					<div class="admin-menu-item" onclick="showAdminTab('adminStoresTab')">
						<i class="fas fa-store"></i> Tiendas
					</div>
					<div class="admin-menu-item" onclick="showAdminTab('adminCategoriesTab')">
						<i class="fas fa-tags"></i> Categorías
					</div>
					<div class="admin-menu-item" onclick="showAdminTab('adminCommissionsTab')">
						<i class="fas fa-percentage"></i> Comisiones
					</div>
					<div class="admin-menu-item" onclick="showAdminTab('adminReportsTab')">
						<i class="fas fa-chart-bar"></i> Informes
					</div>
					<div class="admin-menu-item" onclick="showAdminTab('adminSettingsTab')">
						<i class="fas fa-cog"></i> Configuración
					</div>
				`;
			} else if (isAdmin) {
				menu.innerHTML = `
					<div class="admin-menu-item active" onclick="showAdminTab('adminDashboardTab')">
						<i class="fas fa-tachometer-alt"></i> Dashboard
					</div>
					<div class="admin-menu-item" onclick="showAdminTab('adminCategoriesTab')">
						<i class="fas fa-tags"></i> Categorías
					</div>
					<div class="admin-menu-item" onclick="showAdminTab('adminProductsTab')">
						<i class="fas fa-box"></i> Productos
					</div>
					<div class="admin-menu-item" onclick="showAdminTab('adminCustomersTab')">
						<i class="fas fa-users"></i> Clientes
					</div>
					<div class="admin-menu-item" onclick="showAdminTab('adminAffiliatesTab')">
						<i class="fas fa-handshake"></i> Afiliados
					</div>
					<div class="admin-menu-item" onclick="showAdminTab('adminOrdersTab')">
						<i class="fas fa-shopping-cart"></i> Pedidos
					</div>
					<div class="admin-menu-item" onclick="showAdminTab('adminReportsTab')">
						<i class="fas fa-chart-bar"></i> Reportes
					</div>
					<div class="admin-menu-item" onclick="showAdminTab('adminImportsTab')">
						<i class="fas fa-file-import"></i> Importar Datos
					</div>
					<div class="admin-menu-item" onclick="showAdminTab('adminSettingsTab')">
						<i class="fas fa-cog"></i> Configuración
					</div>
				`;
			} else if (currentUser.role === 'dependiente') {
				menu.innerHTML = `
					<div class="admin-menu-item active" onclick="showAdminTab('adminProductsTab')">
						<i class="fas fa-box"></i> Productos
					</div>
					<div class="admin-menu-item" onclick="showAdminTab('adminOrdersTab')">
						<i class="fas fa-shopping-cart"></i> Pedidos
					</div>
				`;
			}
            // Actualizar título
            if (isOwner) {
                document.getElementById('adminPanelTitle').textContent = 'Panel del Propietario';
                document.getElementById('adminPanelHeader').textContent = 'Panel del Propietario - PaTí';
                document.getElementById('viewSiteButton').style.display = 'inline-block';
            } else if (isAdmin) {
                const store = stores.find(s => s.id === currentStoreId);
                const storeName = store ? store.name : 'Tienda';
                document.getElementById('adminPanelTitle').textContent = `Admin: ${storeName}`;
                document.getElementById('adminPanelHeader').textContent = `Administración de Tienda - ${storeName}`;
                document.getElementById('viewSiteButton').style.display = 'none';
            }
            // Actualizar dashboard
			const dashboardCards = document.querySelectorAll('#adminDashboardTab .summary-value');
			if (dashboardCards.length >= 4) {
				if (isOwner) {
					dashboardCards[0].textContent = stores.length; // Tiendas → ahora solo para propietario
					dashboardCards[1].textContent = products.length;
					dashboardCards[2].textContent = customers.length;
					dashboardCards[3].textContent = affiliates.length;
				} else if (isAdmin) {
					const storeCategories = [...new Set(filteredProducts.map(p => p.categoryId))].length;
					dashboardCards[0].textContent = storeCategories; // Categorías
					dashboardCards[1].textContent = filteredProducts.length; // Productos
					dashboardCards[2].textContent = filteredCustomers.length; // Clientes
					dashboardCards[3].textContent = filteredAffiliates.length; // Afiliados
				} else if (currentUser.role === 'dependiente') {
					dashboardCards[0].textContent = filteredProducts.length; // Productos
					dashboardCards[1].textContent = filteredCustomers.length; // Clientes
					dashboardCards[2].textContent = filteredOrders.length; // Pedidos Hoy
					const salesToday = filteredOrders.reduce((sum, o) => sum + o.total, 0);
					dashboardCards[3].textContent = '$' + salesToday.toFixed(2); // Ventas Hoy
				}
				// Si hay más cartas
				if (dashboardCards.length >= 6) {
					if (currentUser.role !== 'dependiente') {
						dashboardCards[4].textContent = filteredOrders.length;
						const salesToday = filteredOrders.reduce((sum, o) => sum + o.total, 0);
						dashboardCards[5].textContent = '$' + salesToday.toFixed(2);
					}
				}
			}            showAdminTab('adminDashboardTab');
        }
        function loadAdminStores() {
            const tableBody = document.getElementById('adminStoresTable');
            tableBody.innerHTML = '';
            stores.forEach(store => {
                const category = categories.find(c => c.id === store.categoryId)?.name || 'Sin categoría';
                const row = `
                    <tr>
                        <td>${store.id}</td>
                        <td>${store.name}</td>
                        <td>${category}</td>
                        <td>${store.admin}</td>
                        <td><span class="badge ${store.status === 'Activo' ? 'bg-success' : 'bg-secondary'}">${store.status}</span></td>
                        <td class="action-buttons">
                            <button class="btn btn-sm btn-info" onclick="viewStore(${store.id})">
                                <i class="fas fa-eye"></i>
                            </button>
                            <button class="btn btn-sm btn-warning" onclick="editStore(${store.id})">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="btn btn-sm ${store.status === 'Activo' ? 'bg-secondary' : 'bg-success'}" onclick="toggleStoreStatus(${store.id})">
                                <i class="fas ${store.status === 'Activo' ? 'fa-pause' : 'fa-play'}"></i>
                            </button>
                            <button class="btn btn-sm btn-danger" onclick="deleteStore(${store.id})">
                                <i class="fas fa-trash"></i>
                            </button>
                        </td>
                    </tr>
                `;
                tableBody.innerHTML += row;
            });
        }
        function loadAdminProducts() {
            const tableBody = document.getElementById('adminProductsTable');
            tableBody.innerHTML = '';
            products.forEach(product => {
                const category = categories.find(c => c.id === product.categoryId)?.name || 'Sin categoría';
                const row = `
                    <tr>
                        <td>${product.id}</td>
                        <td>${product.name}</td>
                        <td>${product.store}</td>
                        <td>${category}</td>
                        <td>
                            <div>1-10: $${product.price1.toFixed(2)}</div>
                            <div>11-50: $${product.price2.toFixed(2)}</div>
                            <div>51+: $${product.price3.toFixed(2)}</div>
                        </td>
                        <td>${product.stock}</td>
                        <td class="action-buttons">
                            <button class="btn btn-sm btn-info" onclick="viewProduct(${product.id})">
                                <i class="fas fa-eye"></i>
                            </button>
                            <button class="btn btn-sm btn-warning" onclick="editProduct(${product.id})">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="btn btn-sm btn-danger" onclick="deleteProduct(${product.id})">
                                <i class="fas fa-trash"></i>
                            </button>
                        </td>
                    </tr>
                `;
                tableBody.innerHTML += row;
            });
        }
        function loadAdminCategories() {
            const tableBody = document.getElementById('adminCategoriesTable');
            tableBody.innerHTML = '';
            categories.forEach(category => {
                const productCount = products.filter(p => p.categoryId === category.id).length;
                const row = `
                    <tr>
                        <td>${category.id}</td>
                        <td>${category.name}</td>
                        <td>${category.description}</td>
                        <td>${productCount}</td>
                        <td class="action-buttons">
                            <button class="btn btn-sm btn-info" onclick="viewCategory(${category.id})">
                                <i class="fas fa-eye"></i>
                            </button>
                            <button class="btn btn-sm btn-warning" onclick="editCategory(${category.id})">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="btn btn-sm btn-danger" onclick="deleteCategory(${category.id})">
                                <i class="fas fa-trash"></i>
                            </button>
                        </td>
                    </tr>
                `;
                tableBody.innerHTML += row;
            });
        }
        function loadAdminCustomers() {
            const tableBody = document.getElementById('adminCustomersTable');
            tableBody.innerHTML = '';
            customers.forEach(customer => {
                const row = `
                    <tr>
                        <td>${customer.id}</td>
                        <td>${customer.name}</td>
                        <td>${customer.email}</td>
                        <td>${customer.store}</td>
                        <td>${customer.orders}</td>
                        <td class="action-buttons">
                            <button class="btn btn-sm btn-info" onclick="viewCustomer(${customer.id})">
                                <i class="fas fa-eye"></i>
                            </button>
                            <button class="btn btn-sm btn-warning" onclick="editCustomer(${customer.id})">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="btn btn-sm btn-danger" onclick="deleteCustomer(${customer.id})">
                                <i class="fas fa-trash"></i>
                            </button>
                        </td>
                    </tr>
                `;
                tableBody.innerHTML += row;
            });
        }
        function loadAdminAffiliates() {
            const tableBody = document.getElementById('adminAffiliatesTable');
            tableBody.innerHTML = '';
            affiliates.forEach(affiliate => {
                const row = `
                    <tr>
                        <td>${affiliate.id}</td>
                        <td>${affiliate.name}</td>
                        <td>${affiliate.email}</td>
                        <td>${affiliate.store}</td>
                        <td>${affiliate.commission}%</td>
                        <td>${affiliate.sales}</td>
                        <td><span class="badge ${affiliate.status === 'Activo' ? 'bg-success' : 'bg-secondary'}">${affiliate.status}</span></td>
                        <td class="action-buttons">
                            <button class="btn btn-sm btn-info" onclick="viewAffiliate(${affiliate.id})">
                                <i class="fas fa-eye"></i>
                            </button>
                            <button class="btn btn-sm btn-warning" onclick="editAffiliate(${affiliate.id})">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="btn btn-sm btn-danger" onclick="deleteAffiliate(${affiliate.id})">
                                <i class="fas fa-trash"></i>
                            </button>
                        </td>
                    </tr>
                `;
                tableBody.innerHTML += row;
            });
        }
        function loadAdminOrders() {
            const tableBody = document.getElementById('adminOrdersTable');
            tableBody.innerHTML = '';
            orders.forEach(order => {
                const statusClass = 
                    order.status === 'Entregado' ? 'bg-success' :
                    order.status === 'En camino' ? 'bg-warning' :
                    order.status === 'Procesando' ? 'bg-info' : 'bg-secondary';
                const row = `
                    <tr>
                        <td>#${order.id}</td>
                        <td>${order.customer}</td>
                        <td>${order.store}</td>
                        <td>${order.date}</td>
                        <td>$${order.total.toFixed(2)}</td>
                        <td><span class="badge ${statusClass}">${order.status}</span></td>
                        <td class="action-buttons">
                            <button class="btn btn-sm btn-info" onclick="viewOrder(${order.id})">
                                <i class="fas fa-eye"></i>
                            </button>
                            <button class="btn btn-sm btn-warning" onclick="editOrder(${order.id})">
                                <i class="fas fa-edit"></i>
                            </button>
                        </td>
                    </tr>
                `;
                tableBody.innerHTML += row;
            });
        }
        function loadAdminCommissions() {
            const tableBody = document.getElementById('adminCommissionsTable');
            if (!tableBody) return;
            tableBody.innerHTML = '';
            storeCommissions.forEach(commission => {
                const row = `
                    <tr>
                        <td>${commission.id}</td>
                        <td>${commission.storeName}</td>
                        <td>${commission.commission}%</td>
                        <td class="action-buttons">
                            <button class="btn btn-sm btn-warning" onclick="editCommission(${commission.id})">
                                <i class="fas fa-edit"></i>
                            </button>
                        </td>
                    </tr>
                `;
                tableBody.innerHTML += row;
            });
        }
        function editCommission(commissionId) {
            const commission = storeCommissions.find(c => c.id === commissionId);
            if (commission) {
                document.getElementById('editCommissionId').value = commission.id;
                document.getElementById('editCommissionStore').value = commission.storeName;
                document.getElementById('editCommissionValue').value = commission.commission;
                const editCommissionModal = new bootstrap.Modal(document.getElementById('editCommissionModal'));
                editCommissionModal.show();
            }
        }
        function saveCommission() {
            const commissionId = parseInt(document.getElementById('editCommissionId').value);
            const commissionValue = parseFloat(document.getElementById('editCommissionValue').value);
            const commission = storeCommissions.find(c => c.id === commissionId);
            if (commission) {
                commission.commission = commissionValue;
                loadAdminCommissions();
                const editCommissionModal = bootstrap.Modal.getInstance(document.getElementById('editCommissionModal'));
                editCommissionModal.hide();
                showNotification('Comisión actualizada correctamente');
            }
        }
        function populateStoreSelects() {
            const selects = [
                'productStore',
                'affiliateStore',
                'editProductStore',
                'editCustomerStore',
                'editAffiliateStore',
                'editOrderStore'
            ];
            selects.forEach(selectId => {
                const select = document.getElementById(selectId);
                if (select) {
                    select.innerHTML = '<option value="">Seleccionar tienda</option>';
                    stores.forEach(store => {
                        const option = document.createElement('option');
                        option.value = store.id;
                        option.textContent = store.name;
                        select.appendChild(option);
                    });
                }
            });
        }
        function addStore() {
            const name = document.getElementById('newStoreName').value;
            const category = document.getElementById('newStoreCategory').value;
            const adminName = document.getElementById('newAdminName').value;
            const adminEmail = document.getElementById('newAdminEmail').value;
            const adminPassword = document.getElementById('newAdminPassword').value;
            const adminPhone = document.getElementById('newAdminPhone').value;
            const description = document.getElementById('newStoreDescription').value;
            const image = document.getElementById('newStoreImage').value || 'https://images.unsplash.com/photo-1607082348824-0a96f2a4b9da?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80';
            const logo = document.getElementById('newStoreLogo').value;
            const newId = stores.length > 0 ? Math.max(...stores.map(s => s.id)) + 1 : 1;
            stores.push({
                id: newId,
                name,
                categoryId: category,
                admin: adminEmail,
                status: "Activo",
                image,
                logo,
                description
            });
            loadAdminStores();
            populateStoreSelects();
            const modal = bootstrap.Modal.getInstance(document.getElementById('addStoreModal'));
            modal.hide();
            document.getElementById('addStoreForm').reset();
            showNotification('Tienda agregada correctamente');
        }
        function addProduct() {
            const name = document.getElementById('productName').value;
            const storeId = parseInt(document.getElementById('productStore').value);
            const store = stores.find(s => s.id === storeId);
            const category = document.getElementById('productCategory').value;
            const price1 = parseFloat(document.getElementById('productPrice1').value);
            const price2 = parseFloat(document.getElementById('productPrice2').value);
            const price3 = parseFloat(document.getElementById('productPrice3').value);
            const stock = parseInt(document.getElementById('productStock').value);
            const description = document.getElementById('productDescription').value;
            const image = document.getElementById('productImage').value || 'https://images.unsplash.com/photo-1505740420928-5e560c06d30e?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80';
            const newId = products.length > 0 ? Math.max(...products.map(p => p.id)) + 1 : 1;
            products.push({
                id: newId,
                name,
                store: store.name,
                storeId,
                categoryId: category,
                price1,
                price2,
                price3,
                stock,
                description,
                image
            });
            loadAdminProducts();
            const modal = bootstrap.Modal.getInstance(document.getElementById('addProductModal'));
            modal.hide();
            document.getElementById('addProductForm').reset();
            showNotification('Producto agregado correctamente');
        }
        function addCategory() {
            const name = document.getElementById('categoryName').value;
            const description = document.getElementById('categoryDescription').value;
            const newId = categories.length > 0 ? Math.max(...categories.map(c => c.id)) + 1 : 1;
            categories.push({
                id: newId,
                name,
                description
            });
            loadAdminCategories();
            const modal = bootstrap.Modal.getInstance(document.getElementById('addCategoryModal'));
            modal.hide();
            document.getElementById('addCategoryForm').reset();
            showNotification('Categoría agregada correctamente');
        }
        function addAffiliate() {
            const storeId = parseInt(document.getElementById('affiliateStore').value);
            const store = stores.find(s => s.id === storeId);
            const name = document.getElementById('affiliateName').value;
            const email = document.getElementById('affiliateEmail').value;
            const commission = parseFloat(document.getElementById('affiliateCommission').value);
            const status = document.getElementById('affiliateStatus').value;
            const newId = affiliates.length > 0 ? Math.max(...affiliates.map(a => a.id)) + 1 : 1;
            affiliates.push({
                id: newId,
                name,
                email,
                storeId,
                store: store.name,
                commission,
                sales: 0,
                status
            });
            loadAdminAffiliates();
            const modal = bootstrap.Modal.getInstance(document.getElementById('addAffiliateModal'));
            modal.hide();
            document.getElementById('addAffiliateForm').reset();
            showNotification('Afiliado agregado correctamente');
        }
        function toggleStoreStatus(storeId) {
            const store = stores.find(s => s.id === storeId);
            if (store) {
                store.status = store.status === 'Activo' ? 'Inactivo' : 'Activo';
                loadAdminStores();
                showNotification(`Tienda ${store.name} ${store.status === 'Activo' ? 'activada' : 'desactivada'} correctamente`);
            }
        }
        function deleteStore(storeId) {
            if (confirm('¿Estás seguro de que quieres eliminar esta tienda? Esta acción no se puede deshacer.')) {
                const index = stores.findIndex(s => s.id === storeId);
                if (index !== -1) {
                    const storeName = stores[index].name;
                    stores.splice(index, 1);
                    for (let i = products.length - 1; i >= 0; i--) {
                        if (products[i].storeId === storeId) {
                            products.splice(i, 1);
                        }
                    }
                    for (let i = affiliates.length - 1; i >= 0; i--) {
                        if (affiliates[i].storeId === storeId) {
                            affiliates.splice(i, 1);
                        }
                    }
                    loadAdminStores();
                    loadAdminProducts();
                    loadAdminAffiliates();
                    populateStoreSelects();
                    showNotification(`Tienda ${storeName} eliminada correctamente`);
                }
            }
        }
        function deleteProduct(id) {
            if (confirm('¿Estás seguro de que quieres eliminar este producto?')) {
                const index = products.findIndex(p => p.id === id);
                if (index !== -1) {
                    products.splice(index, 1);
                    loadAdminProducts();
                    showNotification('Producto eliminado correctamente');
                }
            }
        }
        function deleteCategory(id) {
            if (confirm('¿Estás seguro de que quieres eliminar esta categoría?')) {
                const index = categories.findIndex(c => c.id === id);
                if (index !== -1) {
                    categories.splice(index, 1);
                    loadAdminCategories();
                    showNotification('Categoría eliminada correctamente');
                }
            }
        }
        function deleteCustomer(id) {
            if (confirm('¿Estás seguro de que quieres eliminar este cliente?')) {
                const index = customers.findIndex(c => c.id === id);
                if (index !== -1) {
                    customers.splice(index, 1);
                    loadAdminCustomers();
                    showNotification('Cliente eliminado correctamente');
                }
            }
        }
        function deleteAffiliate(id) {
            if (confirm('¿Estás seguro de que quieres eliminar este afiliado?')) {
                const index = affiliates.findIndex(a => a.id === id);
                if (index !== -1) {
                    affiliates.splice(index, 1);
                    loadAdminAffiliates();
                    showNotification('Afiliado eliminado correctamente');
                }
            }
        }
        function viewStore(storeId) {
            const store = stores.find(s => s.id === storeId);
            if (store) {
                const viewStoreModal = document.getElementById('viewStoreModal');
                if (viewStoreModal) {
                    document.getElementById('viewStoreName').textContent = store.name;
                    document.getElementById('viewStoreCategory').textContent = categories.find(c => c.id === store.categoryId)?.name || 'Sin categoría';
                    document.getElementById('viewStoreAdmin').textContent = store.admin;
                    document.getElementById('viewStoreStatus').textContent = store.status;
                    document.getElementById('viewStoreDescription').textContent = store.description;
                    document.getElementById('viewStoreImage').src = store.image;
                    const modal = new bootstrap.Modal(viewStoreModal);
                    modal.show();
                }
            }
        }
        function editStore(storeId) {
            const store = stores.find(s => s.id === storeId);
            if (store) {
                const editStoreModal = document.getElementById('editStoreModal');
                if (editStoreModal) {
                    document.getElementById('editStoreId').value = store.id;
                    document.getElementById('editStoreName').value = store.name;
                    document.getElementById('editStoreCategory').value = store.categoryId;
                    document.getElementById('editStoreAdmin').value = store.admin;
                    document.getElementById('editStoreStatus').value = store.status;
                    document.getElementById('editStoreDescription').value = store.description;
                    document.getElementById('editStoreImage').value = store.image;
                    const modal = new bootstrap.Modal(editStoreModal);
                    modal.show();
                }
            }
        }
        function saveStore() {
            const storeId = parseInt(document.getElementById('editStoreId').value);
            const store = stores.find(s => s.id === storeId);
            if (store) {
                store.name = document.getElementById('editStoreName').value;
                store.categoryId = document.getElementById('editStoreCategory').value;
                store.admin = document.getElementById('editStoreAdmin').value;
                store.status = document.getElementById('editStoreStatus').value;
                store.description = document.getElementById('editStoreDescription').value;
                store.image = document.getElementById('editStoreImage').value;
                loadAdminStores();
                const editStoreModal = bootstrap.Modal.getInstance(document.getElementById('editStoreModal'));
                editStoreModal.hide();
                showNotification('Tienda actualizada correctamente');
            }
        }
        // Funciones para ver detalles
        function viewProduct(productId) {
            const product = products.find(p => p.id === productId);
            if (product) {
                document.getElementById('viewProductName').textContent = product.name;
                document.getElementById('viewProductStore').textContent = product.store;
                document.getElementById('viewProductCategory').textContent = categories.find(c => c.id === product.categoryId)?.name || 'Sin categoría';
                document.getElementById('viewProductPrices').innerHTML = `
                    <div>1-10: $${product.price1.toFixed(2)}</div>
                    <div>11-50: $${product.price2.toFixed(2)}</div>
                    <div>51+: $${product.price3.toFixed(2)}</div>
                `;
                document.getElementById('viewProductStock').textContent = product.stock;
                document.getElementById('viewProductDescription').textContent = product.description;
                document.getElementById('viewProductImage').src = product.image;
                const viewProductModal = new bootstrap.Modal(document.getElementById('viewProductModal'));
                viewProductModal.show();
            }
        }
        function viewCategory(categoryId) {
            const category = categories.find(c => c.id === categoryId);
            if (category) {
                document.getElementById('viewCategoryName').textContent = category.name;
                document.getElementById('viewCategoryDescription').textContent = category.description;
                const productCount = products.filter(p => p.categoryId === category.id).length;
                document.getElementById('viewCategoryProducts').textContent = productCount;
                const viewCategoryModal = new bootstrap.Modal(document.getElementById('viewCategoryModal'));
                viewCategoryModal.show();
            }
        }
        function viewCustomer(customerId) {
            const customer = customers.find(c => c.id === customerId);
            if (customer) {
                document.getElementById('viewCustomerName').textContent = customer.name;
                document.getElementById('viewCustomerEmail').textContent = customer.email;
                document.getElementById('viewCustomerPhone').textContent = customer.phone;
                document.getElementById('viewCustomerStore').textContent = customer.store;
                document.getElementById('viewCustomerOrders').textContent = customer.orders;
                const viewCustomerModal = new bootstrap.Modal(document.getElementById('viewCustomerModal'));
                viewCustomerModal.show();
            }
        }
        function viewAffiliate(affiliateId) {
            const affiliate = affiliates.find(a => a.id === affiliateId);
            if (affiliate) {
                document.getElementById('viewAffiliateName').textContent = affiliate.name;
                document.getElementById('viewAffiliateEmail').textContent = affiliate.email;
                document.getElementById('viewAffiliateStore').textContent = affiliate.store;
                document.getElementById('viewAffiliateCommission').textContent = affiliate.commission + '%';
                document.getElementById('viewAffiliateSales').textContent = affiliate.sales;
                document.getElementById('viewAffiliateStatus').textContent = affiliate.status;
                const viewAffiliateModal = new bootstrap.Modal(document.getElementById('viewAffiliateModal'));
                viewAffiliateModal.show();
            }
        }
        function viewOrder(orderId) {
            const order = orders.find(o => o.id === orderId);
            if (order) {
                document.getElementById('viewOrderId').textContent = '#' + order.id;
                document.getElementById('viewOrderCustomer').textContent = order.customer;
                document.getElementById('viewOrderStore').textContent = order.store;
                document.getElementById('viewOrderDate').textContent = order.date;
                document.getElementById('viewOrderTotal').textContent = '$' + order.total.toFixed(2);
                document.getElementById('viewOrderStatus').textContent = order.status;
                const viewOrderModal = new bootstrap.Modal(document.getElementById('viewOrderModal'));
                viewOrderModal.show();
            }
        }
        // Funciones para editar
        function editProduct(productId) {
            const product = products.find(p => p.id === productId);
            if (product) {
                document.getElementById('editProductId').value = product.id;
                document.getElementById('editProductName').value = product.name;
                document.getElementById('editProductStore').value = product.storeId;
                document.getElementById('editProductCategory').value = product.categoryId;
                document.getElementById('editProductPrice1').value = product.price1;
                document.getElementById('editProductPrice2').value = product.price2;
                document.getElementById('editProductPrice3').value = product.price3;
                document.getElementById('editProductStock').value = product.stock;
                document.getElementById('editProductDescription').value = product.description;
                document.getElementById('editProductImage').value = product.image;
                const editProductModal = new bootstrap.Modal(document.getElementById('editProductModal'));
                editProductModal.show();
            }
        }
        function editCategory(categoryId) {
            const category = categories.find(c => c.id === categoryId);
            if (category) {
                document.getElementById('editCategoryId').value = category.id;
                document.getElementById('editCategoryName').value = category.name;
                document.getElementById('editCategoryDescription').value = category.description;
                const editCategoryModal = new bootstrap.Modal(document.getElementById('editCategoryModal'));
                editCategoryModal.show();
            }
        }
        function editCustomer(customerId) {
            const customer = customers.find(c => c.id === customerId);
            if (customer) {
                document.getElementById('editCustomerId').value = customer.id;
                document.getElementById('editCustomerName').value = customer.name;
                document.getElementById('editCustomerEmail').value = customer.email;
                document.getElementById('editCustomerPhone').value = customer.phone;
                document.getElementById('editCustomerStore').value = customer.storeId;
                document.getElementById('editCustomerOrders').value = customer.orders;
                const editCustomerModal = new bootstrap.Modal(document.getElementById('editCustomerModal'));
                editCustomerModal.show();
            }
        }
        function editAffiliate(affiliateId) {
            const affiliate = affiliates.find(a => a.id === affiliateId);
            if (affiliate) {
                document.getElementById('editAffiliateId').value = affiliate.id;
                document.getElementById('editAffiliateName').value = affiliate.name;
                document.getElementById('editAffiliateEmail').value = affiliate.email;
                document.getElementById('editAffiliateStore').value = affiliate.storeId;
                document.getElementById('editAffiliateCommission').value = affiliate.commission;
                document.getElementById('editAffiliateStatus').value = affiliate.status;
                const editAffiliateModal = new bootstrap.Modal(document.getElementById('editAffiliateModal'));
                editAffiliateModal.show();
            }
        }
        function editOrder(orderId) {
            const order = orders.find(o => o.id === orderId);
            if (order) {
                document.getElementById('editOrderId').value = order.id;
                document.getElementById('editOrderCustomer').value = order.customer;
                document.getElementById('editOrderStore').value = order.storeId;
                document.getElementById('editOrderDate').value = order.date;
                document.getElementById('editOrderTotal').value = order.total;
                document.getElementById('editOrderStatus').value = order.status;
                const editOrderModal = new bootstrap.Modal(document.getElementById('editOrderModal'));
                editOrderModal.show();
            }
        }
        // Funciones para guardar cambios
        function saveProduct() {
            const productId = parseInt(document.getElementById('editProductId').value);
            const product = products.find(p => p.id === productId);
            const storeId = parseInt(document.getElementById('editProductStore').value);
            const store = stores.find(s => s.id === storeId);
            if (product && store) {
                product.name = document.getElementById('editProductName').value;
                product.store = store.name;
                product.storeId = storeId;
                product.categoryId = document.getElementById('editProductCategory').value;
                product.price1 = parseFloat(document.getElementById('editProductPrice1').value);
                product.price2 = parseFloat(document.getElementById('editProductPrice2').value);
                product.price3 = parseFloat(document.getElementById('editProductPrice3').value);
                product.stock = parseInt(document.getElementById('editProductStock').value);
                product.description = document.getElementById('editProductDescription').value;
                product.image = document.getElementById('editProductImage').value;
                loadAdminProducts();
                const editProductModal = bootstrap.Modal.getInstance(document.getElementById('editProductModal'));
                editProductModal.hide();
                showNotification('Producto actualizado correctamente');
            }
        }
        function saveCategory() {
            const categoryId = parseInt(document.getElementById('editCategoryId').value);
            const category = categories.find(c => c.id === categoryId);
            if (category) {
                category.name = document.getElementById('editCategoryName').value;
                category.description = document.getElementById('editCategoryDescription').value;
                loadAdminCategories();
                const editCategoryModal = bootstrap.Modal.getInstance(document.getElementById('editCategoryModal'));
                editCategoryModal.hide();
                showNotification('Categoría actualizada correctamente');
            }
        }
        function saveCustomer() {
            const customerId = parseInt(document.getElementById('editCustomerId').value);
            const customer = customers.find(c => c.id === customerId);
            const storeId = parseInt(document.getElementById('editCustomerStore').value);
            const store = stores.find(s => s.id === storeId);
            if (customer && store) {
                customer.name = document.getElementById('editCustomerName').value;
                customer.email = document.getElementById('editCustomerEmail').value;
                customer.phone = document.getElementById('editCustomerPhone').value;
                customer.store = store.name;
                customer.storeId = storeId;
                customer.orders = parseInt(document.getElementById('editCustomerOrders').value);
                loadAdminCustomers();
                const editCustomerModal = bootstrap.Modal.getInstance(document.getElementById('editCustomerModal'));
                editCustomerModal.hide();
                showNotification('Cliente actualizado correctamente');
            }
        }
        function saveAffiliate() {
            const affiliateId = parseInt(document.getElementById('editAffiliateId').value);
            const affiliate = affiliates.find(a => a.id === affiliateId);
            const storeId = parseInt(document.getElementById('editAffiliateStore').value);
            const store = stores.find(s => s.id === storeId);
            if (affiliate && store) {
                affiliate.name = document.getElementById('editAffiliateName').value;
                affiliate.email = document.getElementById('editAffiliateEmail').value;
                affiliate.store = store.name;
                affiliate.storeId = storeId;
                affiliate.commission = parseFloat(document.getElementById('editAffiliateCommission').value);
                affiliate.status = document.getElementById('editAffiliateStatus').value;
                loadAdminAffiliates();
                const editAffiliateModal = bootstrap.Modal.getInstance(document.getElementById('editAffiliateModal'));
                editAffiliateModal.hide();
                showNotification('Afiliado actualizado correctamente');
            }
        }
        function saveOrder() {
            const orderId = parseInt(document.getElementById('editOrderId').value);
            const order = orders.find(o => o.id === orderId);
            const storeId = parseInt(document.getElementById('editOrderStore').value);
            const store = stores.find(s => s.id === storeId);
            if (order && store) {
                order.customer = document.getElementById('editOrderCustomer').value;
                order.store = store.name;
                order.storeId = storeId;
                order.date = document.getElementById('editOrderDate').value;
                order.total = parseFloat(document.getElementById('editOrderTotal').value);
                order.status = document.getElementById('editOrderStatus').value;
                loadAdminOrders();
                const editOrderModal = bootstrap.Modal.getInstance(document.getElementById('editOrderModal'));
                editOrderModal.hide();
                showNotification('Pedido actualizado correctamente');
            }
        }
        function generateReport(type) {
            switch(type) {
                case 'sales':
                    alert('Generando reporte de ventas...');
                    downloadExcel('Ventas', [
                        { id: 1001, customer: 'Juan Pérez', store: 'TechZone', date: '2023-05-15', total: 149.97, status: 'Entregado' },
                        { id: 1002, customer: 'María García', store: 'FashionStyle', date: '2023-05-16', total: 89.99, status: 'En camino' },
                        { id: 1003, customer: 'Carlos López', store: 'HomeComfort', date: '2023-05-17', total: 299.99, status: 'Procesando' }
                    ]);
                    break;
                case 'products':
                    alert('Generando reporte de productos...');
                    downloadExcel('Productos', products);
                    break;
                case 'affiliates':
                    alert('Generando reporte de afiliados...');
                    downloadExcel('Afiliados', affiliates);
                    break;
                default:
                    alert('Tipo de reporte no válido');
            }
        }
        function generateCustomReport() {
            const type = document.getElementById('reportType').value;
            const startDate = document.getElementById('reportStartDate').value;
            const endDate = document.getElementById('reportEndDate').value;
            if (!startDate || !endDate) {
                alert('Por favor, selecciona un rango de fechas');
                return;
            }
            alert(`Generando reporte personalizado de ${type} desde ${startDate} hasta ${endDate}`);
            switch(type) {
                case 'sales':
                    downloadExcel('Ventas_Personalizado', [
                        { id: 1001, customer: 'Juan Pérez', store: 'TechZone', date: startDate, total: 149.97, status: 'Entregado' },
                        { id: 1002, customer: 'María García', store: 'FashionStyle', date: endDate, total: 89.99, status: 'En camino' }
                    ]);
                    break;
                case 'products':
                    downloadExcel('Productos_Personalizado', products.slice(0, 3));
                    break;
                case 'customers':
                    downloadExcel('Clientes_Personalizado', customers);
                    break;
                case 'affiliates':
                    downloadExcel('Afiliados_Personalizado', affiliates);
                    break;
            }
        }
        function downloadExcel(sheetName, data) {
            const workbook = new ExcelJS.Workbook();
            const worksheet = workbook.addWorksheet(sheetName);
            const headers = Object.keys(data[0]);
            worksheet.addRow(headers);
            worksheet.getRow(1).eachCell((cell) => {
                cell.font = { bold: true };
                cell.fill = {
                    type: 'pattern',
                    pattern: 'solid',
                    fgColor: { argb: 'FFD4AF37' }
                };
            });
            data.forEach(item => {
                const row = headers.map(header => item[header]);
                worksheet.addRow(row);
            });
            worksheet.columns.forEach(column => {
                let maxLength = 0;
                column.eachCell({ includeEmpty: true }, cell => {
                    const columnLength = cell.value ? cell.value.toString().length : 10;
                    if (columnLength > maxLength) {
                        maxLength = columnLength;
                    }
                });
                column.width = maxLength < 10 ? 10 : maxLength;
            });
            workbook.xlsx.writeBuffer().then(buffer => {
                const blob = new Blob([buffer], { type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' });
                saveAs(blob, `Reporte_${sheetName}_${new Date().toISOString().slice(0,10)}.xlsx`);
            });
        }
        function importStores() {
            const fileInput = document.getElementById('storesFile');
            const file = fileInput.files[0];
            if (!file) {
                alert('Por favor, selecciona un archivo para importar');
                return;
            }
            alert(`Importando tiendas desde: ${file.name}`);
            setTimeout(() => {
                showNotification('Tiendas importadas correctamente');
                loadAdminStores();
                fileInput.value = '';
            }, 2000);
        }
        function importProducts() {
            const fileInput = document.getElementById('productsFile');
            const file = fileInput.files[0];
            if (!file) {
                alert('Por favor, selecciona un archivo para importar');
                return;
            }
            alert(`Importando productos desde: ${file.name}`);
            setTimeout(() => {
                showNotification('Productos importados correctamente');
                loadAdminProducts();
                fileInput.value = '';
            }, 2000);
        }
        function importCategories() {
            const fileInput = document.getElementById('categoriesFile');
            const file = fileInput.files[0];
            if (!file) {
                alert('Por favor, selecciona un archivo para importar');
                return;
            }
            alert(`Importando categorías desde: ${file.name}`);
            setTimeout(() => {
                showNotification('Categorías importadas correctamente');
                loadAdminCategories();
                fileInput.value = '';
            }, 2000);
        }
        function importCustomers() {
            const fileInput = document.getElementById('customersFile');
            const file = fileInput.files[0];
            if (!file) {
                alert('Por favor, selecciona un archivo para importar');
                return;
            }
            alert(`Importando clientes desde: ${file.name}`);
            setTimeout(() => {
                showNotification('Clientes importados correctamente');
                loadAdminCustomers();
                fileInput.value = '';
            }, 2000);
        }
        function importAffiliates() {
            const fileInput = document.getElementById('affiliatesFile');
            const file = fileInput.files[0];
            if (!file) {
                alert('Por favor, selecciona un archivo para importar');
                return;
            }
            alert(`Importando afiliados desde: ${file.name}`);
            setTimeout(() => {
                showNotification('Afiliados importados correctamente');
                loadAdminAffiliates();
                fileInput.value = '';
            }, 2000);
        }
        function initializeCharts() {
            const salesChartElement = document.getElementById('salesChart');
            const categoriesChartElement = document.getElementById('categoriesChart');
            if (salesChartElement && categoriesChartElement) {
                const salesCtx = salesChartElement.getContext('2d');
                new Chart(salesCtx, {
                    type: 'line',
                    data: {
                        labels: ['Lun', 'Mar', 'Mié', 'Jue', 'Vie', 'Sáb', 'Dom'],
                        datasets: [{
                            label: 'Ventas ($)',
                            data: [1200, 1900, 1500, 2100, 1800, 2500, 2200],
                            borderColor: '#D4AF37',
                            backgroundColor: 'rgba(212, 175, 55, 0.1)',
                            tension: 0.3,
                            fill: true
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            legend: {
                                position: 'top',
                            }
                        }
                    }
                });
                const categoriesCtx = categoriesChartElement.getContext('2d');
                new Chart(categoriesCtx, {
                    type: 'doughnut',
                    data: {
                        labels: ['Electrónica', 'Ropas', 'Hogar', 'Deportiva'],
                        datasets: [{
                            data: [40, 25, 20, 15],
                            backgroundColor: [
                                '#D4AF37',
                                '#B8860B',
                                '#8B4513',
                                '#654321'
                            ]
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            legend: {
                                position: 'bottom',
                            }
                        }
                    }
                });
            }
        }
		function loginAsOwner() {
			isAdminLoggedIn = true;
			currentUser = {
				id: 1,
				name: 'Propietario',
				email: 'propietario@pati.com',
				role: 'propietario'
			};
			document.getElementById('mainContent').classList.add('d-none');
			document.getElementById('adminPanel').classList.remove('d-none');
			document.getElementById('authButtons').classList.add('d-none');
			document.getElementById('logoutButton').classList.remove('d-none');
			loadAdminData();
			showNotification('Has iniciado sesión como Propietario');
		}
    </script>
    <!-- View Store Modal -->
    <div class="modal fade" id="viewStoreModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Detalles de la Tienda</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="text-center mb-3">
                        <img id="viewStoreImage" src="" alt="Imagen de la tienda" style="max-width: 100%; height: auto; border-radius: 8px;">
                    </div>
                    <div class="mb-2">
                        <strong>Nombre:</strong> <span id="viewStoreName"></span>
                    </div>
                    <div class="mb-2">
                        <strong>Categoría:</strong> <span id="viewStoreCategory"></span>
                    </div>
                    <div class="mb-2">
                        <strong>Administrador:</strong> <span id="viewStoreAdmin"></span>
                    </div>
                    <div class="mb-2">
                        <strong>Estado:</strong> <span id="viewStoreStatus"></span>
                    </div>
                    <div class="mb-2">
                        <strong>Descripción:</strong> <span id="viewStoreDescription"></span>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                </div>
            </div>
        </div>
    </div>
    <!-- View Product Modal -->
    <div class="modal fade" id="viewProductModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Detalles del Producto</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="text-center mb-3">
                        <img id="viewProductImage" src="" alt="Imagen del producto" style="max-width: 100%; height: auto; border-radius: 8px;">
                    </div>
                    <div class="mb-2">
                        <strong>Nombre:</strong> <span id="viewProductName"></span>
                    </div>
                    <div class="mb-2">
                        <strong>Tienda:</strong> <span id="viewProductStore"></span>
                    </div>
                    <div class="mb-2">
                        <strong>Categoría:</strong> <span id="viewProductCategory"></span>
                    </div>
                    <div class="mb-2">
                        <strong>Precios:</strong>
                        <div id="viewProductPrices"></div>
                    </div>
                    <div class="mb-2">
                        <strong>Stock:</strong> <span id="viewProductStock"></span>
                    </div>
                    <div class="mb-2">
                        <strong>Descripción:</strong> <span id="viewProductDescription"></span>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                </div>
            </div>
        </div>
    </div>
    <!-- View Category Modal -->
    <div class="modal fade" id="viewCategoryModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Detalles de la Categoría</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-2">
                        <strong>Nombre:</strong> <span id="viewCategoryName"></span>
                    </div>
                    <div class="mb-2">
                        <strong>Descripción:</strong> <span id="viewCategoryDescription"></span>
                    </div>
                    <div class="mb-2">
                        <strong>Productos:</strong> <span id="viewCategoryProducts"></span>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                </div>
            </div>
        </div>
    </div>
    <!-- View Customer Modal -->
    <div class="modal fade" id="viewCustomerModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Detalles del Cliente</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-2">
                        <strong>Nombre:</strong> <span id="viewCustomerName"></span>
                    </div>
                    <div class="mb-2">
                        <strong>Email:</strong> <span id="viewCustomerEmail"></span>
                    </div>
                    <div class="mb-2">
                        <strong>Teléfono:</strong> <span id="viewCustomerPhone"></span>
                    </div>
                    <div class="mb-2">
                        <strong>Tienda:</strong> <span id="viewCustomerStore"></span>
                    </div>
                    <div class="mb-2">
                        <strong>Pedidos:</strong> <span id="viewCustomerOrders"></span>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                </div>
            </div>
        </div>
    </div>
    <!-- View Affiliate Modal -->
    <div class="modal fade" id="viewAffiliateModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Detalles del Afiliado</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-2">
                        <strong>Nombre:</strong> <span id="viewAffiliateName"></span>
                    </div>
                    <div class="mb-2">
                        <strong>Email:</strong> <span id="viewAffiliateEmail"></span>
                    </div>
                    <div class="mb-2">
                        <strong>Tienda:</strong> <span id="viewAffiliateStore"></span>
                    </div>
                    <div class="mb-2">
                        <strong>Comisión:</strong> <span id="viewAffiliateCommission"></span>
                    </div>
                    <div class="mb-2">
                        <strong>Ventas:</strong> <span id="viewAffiliateSales"></span>
                    </div>
                    <div class="mb-2">
                        <strong>Estado:</strong> <span id="viewAffiliateStatus"></span>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                </div>
            </div>
        </div>
    </div>
    <!-- View Order Modal -->
    <div class="modal fade" id="viewOrderModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Detalles del Pedido</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-2">
                        <strong>ID:</strong> <span id="viewOrderId"></span>
                    </div>
                    <div class="mb-2">
                        <strong>Cliente:</strong> <span id="viewOrderCustomer"></span>
                    </div>
                    <div class="mb-2">
                        <strong>Tienda:</strong> <span id="viewOrderStore"></span>
                    </div>
                    <div class="mb-2">
                        <strong>Fecha:</strong> <span id="viewOrderDate"></span>
                    </div>
                    <div class="mb-2">
                        <strong>Total:</strong> <span id="viewOrderTotal"></span>
                    </div>
                    <div class="mb-2">
                        <strong>Estado:</strong> <span id="viewOrderStatus"></span>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                </div>
            </div>
        </div>
    </div>
    <!-- Edit Store Modal -->
    <div class="modal fade" id="editStoreModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Editar Tienda</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="editStoreForm">
                        <input type="hidden" id="editStoreId">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="editStoreName" class="form-label">Nombre de la Tienda</label>
                                    <input type="text" class="form-control" id="editStoreName" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="editStoreCategory" class="form-label">Categoría Principal</label>
                                    <select class="form-select" id="editStoreCategory" required>
                                        <option value="">Seleccionar categoría</option>
                                        <option value="C001">Electrónica</option>
                                        <option value="C002">Hogar</option>
                                        <option value="C003">Útiles y Herramientas</option>
                                        <option value="C004">Ropas</option>
                                        <option value="C005">Calzados</option>
                                        <option value="C006">Deportiva</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="editStoreAdmin" class="form-label">Correo del Administrador</label>
                                    <input type="email" class="form-control" id="editStoreAdmin" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="editStoreStatus" class="form-label">Estado</label>
                                    <select class="form-select" id="editStoreStatus" required>
                                        <option value="Activo">Activo</option>
                                        <option value="Inactivo">Inactivo</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="editStoreDescription" class="form-label">Descripción de la Tienda</label>
                            <textarea class="form-control" id="editStoreDescription" rows="3" required></textarea>
                        </div>
                        <div class="mb-3">
                            <label for="editStoreImage" class="form-label">URL de Imagen Representativa</label>
                            <input type="url" class="form-control" id="editStoreImage">
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-primary" onclick="saveStore()">Guardar Cambios</button>
                </div>
            </div>
        </div>
    </div>
    <!-- Edit Product Modal -->
    <div class="modal fade" id="editProductModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Editar Producto</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="editProductForm">
                        <input type="hidden" id="editProductId">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="editProductName" class="form-label">Nombre</label>
                                    <input type="text" class="form-control" id="editProductName" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="editProductStore" class="form-label">Tienda</label>
                                    <select class="form-select" id="editProductStore" required>
                                        <option value="">Seleccionar tienda</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="editProductCategory" class="form-label">Categoría</label>
                                    <select class="form-select" id="editProductCategory" required>
                                        <option value="">Seleccionar categoría</option>
                                        <option value="C001">Electrónica</option>
                                        <option value="C002">Hogar</option>
                                        <option value="C003">Útiles y Herramientas</option>
                                        <option value="C004">Ropas</option>
                                        <option value="C005">Calzados</option>
                                        <option value="C006">Deportiva</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="editProductStock" class="form-label">Stock</label>
                                    <input type="number" class="form-control" id="editProductStock" required>
                                </div>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Precios por Cantidad</label>
                            <div class="row">
                                <div class="col-md-4">
                                    <div class="input-group mb-3">
                                        <span class="input-group-text">1-10</span>
                                        <input type="number" step="0.01" class="form-control" id="editProductPrice1" placeholder="Precio" required>
                                        <span class="input-group-text">USD</span>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="input-group mb-3">
                                        <span class="input-group-text">11-50</span>
                                        <input type="number" step="0.01" class="form-control" id="editProductPrice2" placeholder="Precio" required>
                                        <span class="input-group-text">USD</span>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="input-group mb-3">
                                        <span class="input-group-text">51+</span>
                                        <input type="number" step="0.01" class="form-control" id="editProductPrice3" placeholder="Precio" required>
                                        <span class="input-group-text">USD</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="editProductDescription" class="form-label">Descripción</label>
                            <textarea class="form-control" id="editProductDescription" rows="3"></textarea>
                        </div>
                        <div class="mb-3">
                            <label for="editProductImage" class="form-label">Imagen URL</label>
                            <input type="url" class="form-control" id="editProductImage">
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-primary" onclick="saveProduct()">Guardar Cambios</button>
                </div>
            </div>
        </div>
    </div>
    <!-- Edit Category Modal -->
    <div class="modal fade" id="editCategoryModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Editar Categoría</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="editCategoryForm">
                        <input type="hidden" id="editCategoryId">
                        <div class="mb-3">
                            <label for="editCategoryName" class="form-label">Nombre</label>
                            <input type="text" class="form-control" id="editCategoryName" required>
                        </div>
                        <div class="mb-3">
                            <label for="editCategoryDescription" class="form-label">Descripción</label>
                            <textarea class="form-control" id="editCategoryDescription" rows="3"></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-primary" onclick="saveCategory()">Guardar Cambios</button>
                </div>
            </div>
        </div>
    </div>
    <!-- Edit Customer Modal -->
    <div class="modal fade" id="editCustomerModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Editar Cliente</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="editCustomerForm">
                        <input type="hidden" id="editCustomerId">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="editCustomerName" class="form-label">Nombre</label>
                                    <input type="text" class="form-control" id="editCustomerName" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="editCustomerEmail" class="form-label">Email</label>
                                    <input type="email" class="form-control" id="editCustomerEmail" required>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="editCustomerPhone" class="form-label">Teléfono</label>
                                    <input type="tel" class="form-control" id="editCustomerPhone" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="editCustomerStore" class="form-label">Tienda</label>
                                    <select class="form-select" id="editCustomerStore" required>
                                        <option value="">Seleccionar tienda</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="editCustomerOrders" class="form-label">Pedidos</label>
                            <input type="number" class="form-control" id="editCustomerOrders" required>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-primary" onclick="saveCustomer()">Guardar Cambios</button>
                </div>
            </div>
        </div>
    </div>
    <!-- Edit Affiliate Modal -->
    <div class="modal fade" id="editAffiliateModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Editar Afiliado</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="editAffiliateForm">
                        <input type="hidden" id="editAffiliateId">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="editAffiliateName" class="form-label">Nombre</label>
                                    <input type="text" class="form-control" id="editAffiliateName" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="editAffiliateEmail" class="form-label">Email</label>
                                    <input type="email" class="form-control" id="editAffiliateEmail" required>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="editAffiliateStore" class="form-label">Tienda</label>
                                    <select class="form-select" id="editAffiliateStore" required>
                                        <option value="">Seleccionar tienda</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="editAffiliateCommission" class="form-label">Comisión (%)</label>
                                    <input type="number" class="form-control" id="editAffiliateCommission" min="0" max="100" step="0.1" required>
                                </div>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="editAffiliateStatus" class="form-label">Estado</label>
                            <select class="form-select" id="editAffiliateStatus" required>
                                <option value="Activo">Activo</option>
                                <option value="Inactivo">Inactivo</option>
                            </select>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-primary" onclick="saveAffiliate()">Guardar Cambios</button>
                </div>
            </div>
        </div>
    </div>
    <!-- Edit Order Modal -->
    <div class="modal fade" id="editOrderModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Editar Pedido</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="editOrderForm">
                        <input type="hidden" id="editOrderId">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="editOrderCustomer" class="form-label">Cliente</label>
                                    <input type="text" class="form-control" id="editOrderCustomer" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="editOrderStore" class="form-label">Tienda</label>
                                    <select class="form-select" id="editOrderStore" required>
                                        <option value="">Seleccionar tienda</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="editOrderDate" class="form-label">Fecha</label>
                                    <input type="date" class="form-control" id="editOrderDate" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="editOrderTotal" class="form-label">Total</label>
                                    <input type="number" step="0.01" class="form-control" id="editOrderTotal" required>
                                </div>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="editOrderStatus" class="form-label">Estado</label>
                            <select class="form-select" id="editOrderStatus" required>
                                <option value="Procesando">Procesando</option>
                                <option value="En camino">En camino</option>
                                <option value="Entregado">Entregado</option>
                                <option value="Cancelado">Cancelado</option>
                            </select>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-primary" onclick="saveOrder()">Guardar Cambios</button>
                </div>
            </div>
        </div>
    </div>
</body>
</html>


